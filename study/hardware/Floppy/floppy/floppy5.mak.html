
<HTML>
<HEAD>
<TITLE> </TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="owner"     CONTENT="call-ibm@austin.ibm.com">
<META NAME="keywords"  CONTENT="RS/6000 RISC AIX UNIX IBM">
<META NAME="description"  CONTENT="The IBM RS/6000 Home Page">
<META NAME="author"  CONTENT="call-ibm@austin.ibm.com">
<META NAME="contact"  CONTENT="call-ibm@austin.ibm.com">
<META NAME="review"  CONTENT="19981109">
<META NAME="security"  CONTENT="public">
</HEAD>

<!-- BEGIN HEADER -->
<!-- END HEADER -->

<!-- BEGIN LEFT NAVIGATION -->
<!-- END LEFT NAVIGATION -->

<!-- BEGIN CONTENT -->
<!-- Header End ---- IBM RS/6000 --------------------->
<!-- end rfish head -->
<A HREF="io_ref.bk.html"><IMG SRC="fm2html-toc.gif">Table of Contents</A> <A HREF="dma5.mak.html"><IMG SRC="fm2html-previous.gif">Previous Chapter</A> <!-- This file was created with the fm2html filter.The filter is copyright Norwegian Telecom Research and was programmed by Jon Stephenson von Tetzchner.  --><!-- (With modifications by John A. Kingman. 11/95)  --><A NAME="U539122"></A><TITLE> </TITLE>
<BR><B><I> </I></B>
<A NAME="U516737"></A><H1><A NAME="REF29510">Chapter 3 Floppy Disk Controller</A></H1>
<A NAME="U534055"></A><H2><A NAME="HDR0">3.1  General Requirements</A></H2>
<A NAME="U538404"><A HREF="floppy5.mak.html#REF23717">Table 51 on page 31</A> is an excerpt from PowerPC Microprocessor Common Hardware Reference Platform: A System Architecture<I></I>, showing the minimum requirements of the floppy disk controller on CHRP platforms.</A><p>
<pre>
<A NAME="U539135"></A><A NAME="U539279"></A>
<A NAME="U539139"></A><A NAME="REF23717">Table 51. Summary of Minimum Platform Requirements </A> 
=====================================================================================================================
<A NAME="U539151">Subsystem</A> |<A NAME="U539153">Specification</A>    |<A NAME="U539155">Portable</A> |<A NAME="U539157">Personal</A> |<A NAME="U539159">Server</A> |<A NAME="U539161">Description</A>                                                 
==========|=================|=========|=========|=======|============================================================
<A NAME="U539280">Floppy</A>    |                 |<A NAME="U539288">O</A>        |<A NAME="U539294">O</A>        |<A NAME="U539300">O</A>      |<A NAME="U539306"> Not required, but a means to attach for software installa-</A> 
          |<A NAME="U539283">3.5" 1.44 MB MFM</A> |<A NAME="U539289">R</A>        |<A NAME="U539295">R</A>        |<A NAME="U539301">R</A>      |tion must be provided. This may be through a provided       
          |<A NAME="U539284">Media sense</A>      |<A NAME="U539290">R</A>        |<A NAME="U539296">R</A>        |<A NAME="U539302">R</A>      |connector or over a network.                                
          |<A NAME="U539285">Auto eject</A>       |<A NAME="U539291">R</A>        |<A NAME="U539297">R</A>        |<A NAME="U539303">M</A>      |<A NAME="U539307">  Media sense: Implementations must allow polling of the </A>   
          |<A NAME="U539286">Manual eject</A>     |<A NAME="U539292">R</A>        |<A NAME="U539298">R</A>        |<A NAME="U539304">R</A>      |drive up to 100x per second to determine the presence of    
          |                 |         |         |       |media in the drive.                                         
          |                 |         |         |       |<A NAME="U539308">  A method for manual ejection of floppies is required.</A>     
=====================================================================================================================
</pre>
<H3><A NAME="U539131">Requirements:</A></H3>

<DL>
<A NAME="U534057"><DD>3-1.  A Floppy Disk Controller that is compliant with the interfaces as defined in this section must be represented in the Open Firmware device tree for the auto-eject version of the device as identified by the following properties; name=fdc, device_type=fdc, and compatible=chrp,fdc. For the non-auto-eject version of the device, it is represented by the following properties; name=fdc, device_type=fdc, and compatible=pnpPNP,700.</A><BR>

<A NAME="U538961"><DD>3-2.  The firmware must configure the Floppy Disk Controller in the PS/2<TT>[tm]</TT> mode, with enhanced auto-eject or without auto-eject.</A><BR>

<A NAME="U538963"><DD>3-3.  This device must be addressed purely with ISA I/O addresses which can be aliased or non-aliased.</A><BR>

<A NAME="U535484"><DD>3-4.  DMA transfers for the floppy disk controller must be 8-bit DMA slave and must support at least the ISA Compatible Timing mode.</A><BR>

<A NAME="U538975"><DD>3-5.  Interrupts generated by the floppy disk controller must be high true edge sensitive.</A><BR>
</DL>


<A NAME="U538969"><B>Software Implementation Note: </B>The PS/2 mode controllers only support two drives.</A><p>
<A NAME="U535488"><B>Software Implementation Note: </B>The operating system is expected to extract the DMA channel number from the node's dma property. The above requirement means that the operating system need not extract the DMA transfer size, DMA count width, or master vs slave capability from the node's dma property. Firmware must set these fields to the values that match the above requirement. Operating systems are recommended to extract the DMA timing from the node's DMA property, though they are free to default to the ISA Compatibility Timing Mode. Refer to <A HREF="dma5.mak.html#REF38710">Table 23 on page 18</A> for information about other timing modes.</A><p>
<A NAME="U536282"><B>Software Implementation Note: </B>The operating system is expected to extract the interrupt number from the node's interrupts property. The above requirement means that the operating system need not extract the interrupt type from the node's interrupts property. Firmware must set this field to the values that match the above requirement.</A><p>
<A NAME="U536253"><B>Hardware Implementation Note:</B> The Floppy interrupts are not tri-stated but left enabled, unlike CHRP requirement 2-1.</A><p>
<A NAME="U535485"></A><H2><A NAME="HDR1">3.2  Floppy Disk/Tape Media Supported</A></H2>
<H3><A NAME="U534161">Requirements:</A></H3>

<DL>
<A NAME="U534165"><DD>3-6.  The floppy disk controller must support 3.5 inch media with an unformatted capacity of 2 megabytes and a formatted capacity of 1.44 megabytes.</A><BR>

<A NAME="U534174"><DD>3-7.  The floppy disk controller must support the 3.5 inch media with an unformatted capacity of 4 megabytes and a formatted capacity of 2.88 megabytes for purposes of floppy disk port tape backup units.</A><BR>
</DL>


<A NAME="U534142">It is recommended that the floppy disk controller support 3.5 inch media with an unformatted capacity of 1 megabytes and a formatted capacity of 720 kilobytes to enable the use of legacy media of that density.</A><p>
<A NAME="U532691"></A><H2><A NAME="HDR2">3.3  Floppy Disk Controller Open Firmware Properties</A></H2>
<H3><A NAME="U533440">Requirements:</A></H3>

<DL>
<A NAME="U536208"><DD>3-8.  The three sets of registers shown in <A HREF="floppy5.mak.html#REF24251">Table 52 on page 33</A> must be present in the Open Firmware device tree for the auto-eject version of the device as identified by the following properties; name=fdc, device_type=fdc, and compatible=chrp,fdc. </A><BR>

<A NAME="U538913"><DD>3-9.  The first two sets of registers shown in <A HREF="floppy5.mak.html#REF24251">Table 52 on page 33</A> must be present in the Open Firmware device tree for the non-auto-eject version of the device as identified by the following properties; name=fdc, device_type=fdc, and compatible=pnpPNP,700.</A><BR>

<A NAME="U536209"><DD>3-10.  This device must be represented as an ISA device and a child of an ISA bridge node in the Open Firmware device tree.</A><BR>

<A NAME="U536314"><DD>3-11.  A floppy disk controller must be reported in the Open Firmware device tree as specified in the <I>CHRP ISA Floppy Device Binding</I> [<A HREF="refinfo.html#REF37756">16</A>].</A><BR>
</DL>


<A NAME="U536318"><A HREF="floppy5.mak.html#REF24251">Table 52 on page 33</A> gives the registers used by the floppy disk controller.</A><p>
<pre>
<A NAME="U532710"></A>
<A NAME="U532714"></A><A NAME="REF24251">Table 52. Floppy Disk Controller Registers</A> 
=========================================================================
<A NAME="U532720">Offset</A> |<A NAME="U532722">Register</A>                             |<A NAME="U532724">Open Firmware Reg Property</A> 
=======|=====================================|===========================
<A NAME="U532726">0</A>      |<A NAME="U532728">Status Register A (SRA)</A>              |<A NAME="U532730">(reg[1], size = 6)</A>         
-------|-------------------------------------|                           
<A NAME="U532732">1</A>      |<A NAME="U532734">Status Register B (SRB)</A>              |                           
-------|-------------------------------------|                           
<A NAME="U532738">2</A>      |<A NAME="U532740">Digital Output Register (DOR)</A>        |                           
-------|-------------------------------------|                           
<A NAME="U532744">3</A>      |<A NAME="U532746">Tape Drive Register (TDR)</A>            |                           
-------|-------------------------------------|                           
<A NAME="U532750">4</A>      |<A NAME="U532752">Main Status Register (MSR)/</A>          |                           
       |<A NAME="U532753">Data Rate Select Register (DSR)</A>      |                           
-------|-------------------------------------|                           
<A NAME="U532757">5</A>      |<A NAME="U532759">Data Register (FIFO) </A>                |                           
-------|-------------------------------------|---------------------------
<A NAME="U532769">0</A>      |<A NAME="U532771">Digital Input Register (DIR)/</A>        |<A NAME="U534283">(reg[2], size = 1)</A>         
       |<A NAME="U532772">Configuration Control Register (CCR)</A> |                           
-------|-------------------------------------|---------------------------
<A NAME="U532895">0</A>      |<A NAME="U532897">Autoeject Register (AER)</A>             |<A NAME="U533185">(reg[3], size = 1)</A>         
       |                                     |                           
=========================================================================
</pre>
<A NAME="U516786"></A><H2><A NAME="HDR3">3.4  Diskette Drive Controller Registers</A></H2>
<H3><A NAME="U533453">Requirements:</A></H3>

<DL>
<A NAME="U533454"><DD>3-12.  For the device described herein, all the registers defined in <A HREF="floppy5.mak.html#REF12426">Section 3.4.1, "Status Register A (SRA)," on page 33</A> through <A HREF="floppy5.mak.html#REF32018"></A> <A HREF="floppy5.mak.html#REF33824">Section 3.4.10, "Autoeject Register (AEJ)," on page 41</A> must be implemented as described herein.</A><BR>
</DL>


<A NAME="U533451">Two sets of registers are described here, control and status. The control registers each have a unique offset address. Floppy disk operations are split into command, execution and result phases. During the result phase, the status registers described are read through the Data Register FIFO (abbreviated as FIFO).</A><p>
<A NAME="U538427"></A><A NAME="U538428"></A><H3><A NAME="REF12426">3.4.1  Status Register A (SRA)</A></H3>
<pre>
<A NAME="U538431">Table 53. Status Register A (SRA) Characteristics</A> 
=============================================================================================
<A NAME="U538445">Register </A> |<A NAME="U538448">Register</A>   |<A NAME="U538451">Associated </A>  |<A NAME="U538454">Offset </A> |<A NAME="U538457">Read/Write</A>      |<A NAME="U538460">Value when OF </A> |<A NAME="U538462">Software </A>     
<A NAME="U538446">Size</A>      |<A NAME="U538449">Addressing</A> |<A NAME="U538452">Reg Property</A> |<A NAME="U538455">Address</A> |<A NAME="U538458">Characteristics</A> |passes to SW   |<A NAME="U538463">Reset Value</A>   
==========|===========|=============|========|================|===============|==============
<A NAME="U538465">1 byte</A>    |<A NAME="U538467">Direct</A>     |<A NAME="U538469">reg[1]</A>       |<A NAME="U538471">0x00</A>    |<A NAME="U538473">Read Only</A>       |<A NAME="U538477">See <A HREF="floppy5.mak.html#REF68435">Table 54 </A>  </A>|<A NAME="U538482">See <A HREF="floppy5.mak.html#REF68435">Table 54 </A> </A>
          |           |             |        |                |<A HREF="floppy5.mak.html#REF68435">on page 33</A>     |<A HREF="floppy5.mak.html#REF68435">on page 33</A>    
          |           |             |        |                |               |              
=============================================================================================
</pre>
<A NAME="U538485">Status Register A, SRA, monitors the state of the floppy disk interrupt source and some of the disk interface signals.</A><p>
<pre>
<A NAME="U537675"></A>
<A NAME="U530539"></A><A NAME="REF68435">Table 54. Status Register A (SRA)</A> 
===============================================================================================================================
<A NAME="U530543">Bit</A> |<A NAME="U530545"> Function</A>                                                                                    |<A NAME="U530623">Value when </A>   |<A NAME="U530625">Value After </A> 
    |                                                                                             |OF passes to  |Software     
    |                                                                                             |SW            |Reset        
====|=============================================================================================|==============|=============
<A NAME="U530547">7</A>   |<A NAME="U530549">Interrupt Pending: This active high bit reflects the state of the interrupt source from the </A> |<A NAME="U530627">0</A>             |<A NAME="U530629">0</A>            
    |floppy disk controller.                                                                      |              |             
----|---------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U530551">6</A>   |<A NAME="U530553">Reserved</A>                                                                                     |<A NAME="U530631">x</A>             |<A NAME="U530633">x</A>            
----|---------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U530555">5</A>   |<A NAME="U530557"><B>Step:</B> Active high bit reflecting the state of the STEP disk interface output.</A>                |<A NAME="U530635">0</A>             |<A NAME="U530637">0</A>            
----|---------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U530559">4</A>   |<A NAME="U530561"><B>-Track 0:</B> Active low bit reflecting the status of the TRK0 disk interface input.</A>             |<A NAME="U530639">x</A>             |<A NAME="U530641">x</A>            
----|---------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U530563">3</A>   |<A NAME="U530565"><B>Head Select:</B> Active high bit reflecting the status of the HDSEL disk interface output.</A>       |<A NAME="U530643">0</A>             |<A NAME="U530645">0</A>            
----|---------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U530567">2</A>   |<A NAME="U530569"><B>-Index:</B> Active low bit reflecting the INDEX disk interface input.</A>                            |<A NAME="U530647">x</A>             |<A NAME="U530649">x</A>            
----|---------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U530571">1</A>   |<A NAME="U530573"><B>-Write Protect:</B> Active low bit reflecting the WP disk interface input.</A>                       |<A NAME="U530651">x</A>             |<A NAME="U530653">x</A>            
----|---------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U530575">0</A>   |<A NAME="U530577"><B>Direction:</B> Active high bit reflecting the DIR disk interface output.</A>                         |<A NAME="U530655">0</A>             |<A NAME="U530657">0</A>            
    |                                                                                             |              |             
===============================================================================================================================
</pre>
<A NAME="U516804"></A><H3><A NAME="HDR4">3.4.2  Status Register B (SRB)</A></H3>
<pre>
<A NAME="U533469">Table 55. Status Register B (SRB) Characteristics</A> 
=============================================================================================
<A NAME="U533483">Register </A> |<A NAME="U533486">Register</A>   |<A NAME="U533489">Associated </A>  |<A NAME="U533492">Offset </A> |<A NAME="U533495">Read/Wrt</A>        |<A NAME="U533498">Value when OF </A> |<A NAME="U533501">Software </A>     
<A NAME="U533484">Size</A>      |<A NAME="U533487">Addressing</A> |<A NAME="U533490">Reg Property</A> |<A NAME="U533493">Address</A> |<A NAME="U533496">Characteristics</A> |passes to SW   |<A NAME="U533502">Reset Value</A>   
==========|===========|=============|========|================|===============|==============
<A NAME="U533504">1 byte</A>    |<A NAME="U533506">Direct</A>     |<A NAME="U533508">reg[1]</A>       |<A NAME="U533510">0x01</A>    |<A NAME="U533512">Read Only</A>       |<A NAME="U533514">See <A HREF="floppy5.mak.html#REF40047">Table 56 </A>  </A>|<A NAME="U533516">See <A HREF="floppy5.mak.html#REF40047">Table 56 </A> </A>
          |           |             |        |                |<A HREF="floppy5.mak.html#REF40047">on page 34</A>     |<A HREF="floppy5.mak.html#REF40047">on page 34</A>    
          |           |             |        |                |               |              
=============================================================================================
</pre>
<A NAME="U533465">This read-only register shows the status of signals on the diskette drive interface. The write-data and read-data bits change state for each positive transition of the `-write data' or `-read data' signals.</A><p>
<pre>
<A NAME="U537315"></A>
<A NAME="U520719"></A><A NAME="REF40047">Table 56. Status Register B</A> 
=====================================================================================================================================
<A NAME="U518084">Bit</A> |<A NAME="U518086"> Function</A>                                                                                          |<A NAME="U530091">Value when </A>   |<A NAME="U530109">Value After </A> 
    |                                                                                                   |OF passes to  |Software     
    |                                                                                                   |SW            |Reset        
====|===================================================================================================|==============|=============
<A NAME="U518088">7,6</A> |<A NAME="U518090">Reserved</A>                                                                                           |<A NAME="U530093">x</A>             |<A NAME="U530111">x</A>            
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518092">5</A>   |<A NAME="U518094"><B>Drive Select 0:</B> Reflects the status of the Drive Select 0 bit in the DOR, Digital Output Register </A> |<A NAME="U530095">x</A>             |<A NAME="U530113">x</A>            
    |(address2, bit 0). It is cleared after a hardware reset, not a software reset.                     |              |             
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518096">4</A>   |<A NAME="U518098"><B>Write Data:</B> Every inactive edge transition of the WDATA disk interface output causes this bit to </A>  |<A NAME="U530097">0</A>             |<A NAME="U530115">0</A>            
    |change state.                                                                                      |              |             
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518100">3</A>   |<A NAME="U530145"><B>Read Data:</B> Every inactive edge transition of the RDATA disk interface output causes this bit to </A>   |<A NAME="U530099">0</A>             |<A NAME="U530117">0</A>            
    |change states.                                                                                     |              |             
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518104">2</A>   |<A NAME="U518106"><B>Write Gate:</B> Active high bit reflecting the WGATE interface output.</A>                                 |<A NAME="U530101">0</A>             |<A NAME="U530119">0</A>            
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518108">1</A>   |<A NAME="U518110"><B> Motor Enable 1:</B> Active high bit reflecting the status of the MTR1 disk interface output.</A>          |<A NAME="U530103">0</A>             |<A NAME="U530121">x</A>            
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518112">0</A>   |<A NAME="U518114"><B>Motor Enable 0:</B> Active high bit reflecting the status of the MTR0 disk interface output.</A>           |<A NAME="U530105">0</A>             |<A NAME="U530123">x</A>            
    |                                                                                                   |              |             
=====================================================================================================================================
</pre>
<A NAME="U530993"></A><H3><A NAME="HDR5">3.4.3  Digital Output Register (DOR)</A></H3>
<pre>
<A NAME="U533526">Table 57. Digital Output Register (DOR) Characteristics</A> 
=============================================================================================
<A NAME="U533540">Register </A> |<A NAME="U533543">Register</A>   |<A NAME="U533546">Associated </A>  |<A NAME="U533549">Offset </A> |<A NAME="U533552">Read/Wrt</A>        |<A NAME="U533555">Value when OF </A> |<A NAME="U533558">Software </A>     
<A NAME="U533541">Size</A>      |<A NAME="U533544">Addressing</A> |<A NAME="U533547">Reg Property</A> |<A NAME="U533550">Address</A> |<A NAME="U533553">Characteristics</A> |passes to SW   |<A NAME="U533559">Reset Value</A>   
==========|===========|=============|========|================|===============|==============
<A NAME="U533561">1 byte</A>    |<A NAME="U533563">Direct</A>     |<A NAME="U533565">reg[1]</A>       |<A NAME="U533567">0x02</A>    |<A NAME="U533569">Read/Write</A>      |<A NAME="U533571">See <A HREF="floppy5.mak.html#REF59457">Table 58 </A>  </A>|<A NAME="U533573">See <A HREF="floppy5.mak.html#REF59457">Table 58 </A> </A>
          |           |             |        |                |<A HREF="floppy5.mak.html#REF59457">on page 35</A>     |<A HREF="floppy5.mak.html#REF59457">on page 35</A>    
          |           |             |        |                |               |              
=============================================================================================
</pre>
<A NAME="U533522">The Digital Output Register, DOR, controls the drive select and motor enable disk interface outputs, enables the DMA logic, and contains a software reset bit.</A><p>
<pre>
<A NAME="U537682"></A>
<A NAME="U520723"></A><A NAME="REF59457">Table 58. Drive Control Register</A> 
========================================================================================================================================
<A NAME="U518166">Bit</A> |<A NAME="U518168"> Function</A>                                                                                             |<A NAME="U530729">Value when </A>   |<A NAME="U530731">Value After </A> 
    |                                                                                                      |OF passes to  |Software     
    |                                                                                                      |SW            |Reset        
====|======================================================================================================|==============|=============
<A NAME="U518170">7</A>   |<A NAME="U518172"><B>Motor Enable 3: </B>This bit controls the MTR3 disk interface output. A 1 in this bit causes the </A>         |<A NAME="U530733">0</A>             |<A NAME="U530735">x</A>            
    |MTR3 pin to go active.                                                                                |              |             
----|------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518174">6</A>   |<A NAME="U518176"><B>Motor Enable 2: </B>This bit controls the MTR2 disk interface output. A 1 in this bit causes the </A>         |<A NAME="U530737">0</A>             |<A NAME="U530739">x</A>            
    |MTR2 pin to go active.                                                                                |              |             
----|------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518178">5</A>   |<A NAME="U518180"><B>Motor Enable 1: </B>This bit controls the MTR1 disk interface output. A 1 in this bit causes the </A>         |<A NAME="U530741">0</A>             |<A NAME="U530743">x</A>            
    |MTR1 pin to go active.                                                                                |              |             
----|------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518182">4</A>   |<A NAME="U518184"><B>Motor Enable 0): </B>This bit controls the MTR0 disk interface output. A 1 in this bit causes the </A>        |<A NAME="U530745">0</A>             |<A NAME="U530747">x</A>            
    |MTR0 pin to go active.                                                                                |              |             
----|------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518186">3</A>   |<A NAME="U518188">Reserved</A>                                                                                              |<A NAME="U530749">0</A>             |<A NAME="U530751">x</A>            
----|------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518190">2</A>   |<A NAME="U518192"><B>-Reset Controller):</B> Writing a 0 to this bit resets the controller. It remains in the reset condition </A> |<A NAME="U530753">0</A>             |<A NAME="U530755">x</A>            
    |until a 1 is written to this bit. Software resets do not affect the DSR, CCR and other bits of the    |              |             
    |DOR. This bit must be 0 for at least 100ns before a 1 can be written to it.                           |              |             
----|------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518194">1-0</A> |<A NAME="U518196"><B>Drive Select:</B> These two bits are a binary encoding of the four drive selects DR0-DR3. This in-</A>        |<A NAME="U530757">0</A>             |<A NAME="U530759">x</A>            
    |sures that only one drive select output can be active at a time.                                      |              |             
========================================================================================================================================
</pre>
<A NAME="U531044">N/A as the value after soft reset means that the bit value is not affected.</A><p>
<A NAME="U538498"></A><H3><A NAME="HDR6">3.4.4  Tape Drive Register (TDR)</A></H3>
<pre>
<A NAME="U538501">Table 59. Tape Drive Register (TDR) Characteristics</A> 
=============================================================================================
<A NAME="U538515">Register </A> |<A NAME="U538518">Register</A>   |<A NAME="U538521">Associated </A>  |<A NAME="U538524">Offset </A> |<A NAME="U538527">Read/Wrt</A>        |<A NAME="U538530">Value when OF </A> |<A NAME="U538532">Software </A>     
<A NAME="U538516">Size</A>      |<A NAME="U538519">Addressing</A> |<A NAME="U538522">Reg Property</A> |<A NAME="U538525">Address</A> |<A NAME="U538528">Characteristics</A> |passes to SW   |<A NAME="U538533">Reset Value</A>   
==========|===========|=============|========|================|===============|==============
<A NAME="U538535">1 byte</A>    |<A NAME="U538537">Direct</A>     |<A NAME="U538539">reg[1]</A>       |<A NAME="U538541">0x03</A>    |<A NAME="U538543">Read/Write</A>      |<A NAME="U538547">See <A HREF="floppy5.mak.html#REF31430">Table 60 </A>  </A>|<A NAME="U538552">See <A HREF="floppy5.mak.html#REF31430">Table 60 </A> </A>
          |           |             |        |                |<A HREF="floppy5.mak.html#REF31430">on page 36</A>     |<A HREF="floppy5.mak.html#REF31430">on page 36</A>    
          |           |             |        |                |               |              
=============================================================================================
</pre>
<A NAME="U533579">The TDR register is the Tape Drive Register and the floppy disk controller media and drive type register. Only what has been called the "enhanced" mode of operation is supported and documented here.</A><p>
<pre>
<A NAME="U536327"></A>
<A NAME="U520727"></A><A NAME="REF31430">Table 60. Drive Status Register</A> 
============================================================================================================================================================
<A NAME="U518246">Bit</A> |<A NAME="U518248"> Function</A>                                                                                                                 |<A NAME="U530789">Value when </A>   |<A NAME="U530791">Value After </A> 
    |                                                                                                                          |OF passes to  |Software     
    |                                                                                                                          |SW            |Reset        
====|==========================================================================================================================|==============|=============
<A NAME="U518250">7</A>   |<A NAME="U518252"><B>Extra Density: </B>When bit 5 is 0, this media id bit is used with bit 6 as described in <A HREF="floppy5.mak.html#REF22414">Table 61 on page 36</A> to indi-</A>         |<A NAME="U530793">x</A>             |<A NAME="U530795">x</A>            
    |cate the type of media currently in the floppy drive                                                                      |              |             
----|--------------------------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U531346">6</A>   |<A NAME="U531348"><B>High Density: </B>When bit 5 is 0, this media id bit is used with bit 7 as described in <A HREF="floppy5.mak.html#REF22414">Table 61 on page 36</A> to indi-</A>          |<A NAME="U531350">x</A>             |<A NAME="U531352">x</A>            
    |cate the type of media currently in the floppy drive.                                                                     |              |             
----|--------------------------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518254">5</A>   |<A NAME="U518256"><B>Drive ID 1 Information: </B>The state of this bit is determined by the state of bits 1 and 0 in the Drive ID register. </A>       |<A NAME="U530797">x</A>             |<A NAME="U530799">x</A>            
    |If this bit is 0, there is valid media ID sense data in bits 7 and 6 of this register. This bit holds the value of bit 1  |              |             
    |of the Drive ID register, when drive 0 is accessed and media sense is configured. It holds the value of bit 3 of          |              |             
    |the Drive ID register, when drive 1 is accessed and media sense is configured. Otherwise, it is set to 1 to indi-         |              |             
    |cate that media information is not available. Valid data should be used only when accessing drives 0 and/or 1.            |              |             
    |<A HREF="floppy5.mak.html#REF22414">Table 61 on page 36</A> shows what the decoded interpretations of bits 7-5 mean.                                              |              |             
----|--------------------------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518258">4</A>   |<A NAME="U518260"><B>Drive ID 0 Information: </B>This bit reflects the value of bit 0 in the Drive ID Register if floppy disk device 0 is </A>         |<A NAME="U530801">x</A>             |<A NAME="U530803">x</A>            
    |accessed. It reflects the value of bit 2 in the Drive ID Register if floppy disk device 1 is accessed                     |              |             
----|--------------------------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U518262">3-2</A> |<A NAME="U518264"><B>Logical Drive Exchange: </B>These bits are reserved, and must be set to zero.</A>                                                 |<A NAME="U530805">0</A>             |<A NAME="U530807">0</A>            
----|--------------------------------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U531395">1-0</A> |<A NAME="U531397"><B>Tape Select 1,0: </B>These bits assign a logical drive number to a tape drive. Drive 0 must remain as a boot drive </A>           |<A NAME="U531399">0</A>             |<A NAME="U531401">0</A>            
    |and cannot be assigned as a tape drive. <A HREF="floppy5.mak.html#REF25103">Table 62 on page 36</A> shows how these bits assign logical drive numbers             |              |             
    |to tape drives                                                                                                            |              |             
============================================================================================================================================================
</pre>
<pre>
<A NAME="U536392"></A>
<A NAME="U536393"></A><A NAME="REF22414">Table 61. Media ID Bit Functions</A> 
======================================
<A NAME="U536397">Bit 7, 6,5</A> |<A NAME="U536399">Media Type</A>                
===========|==========================
<A NAME="U536401">X X 1</A>      |<A NAME="U536403">Invalid Data</A>              
-----------|--------------------------
<A NAME="U536405">0 0 0</A>      |<A NAME="U536407">5.25 in</A>                   
-----------|--------------------------
<A NAME="U536409">0 1 0</A>      |<A NAME="U536411">2.88 Megabyte (formatted)</A> 
-----------|--------------------------
<A NAME="U536413">1 0 0</A>      |<A NAME="U536415">1.44 Megabyte (formatted)</A> 
-----------|--------------------------
<A NAME="U536417">1 1 0</A>      |<A NAME="U536419">720 Kilobyte (formatted)</A>  
           |                          
======================================
</pre>
<A NAME="U536422"><B>Software Implementation Note:</B>The Drive ID register in <A HREF="floppy5.mak.html#REF31430">Table 60 on page 36</A>, is not part of the Floppy Disk Controller register set. It is a register where the chipset involved has stored the Drive IDs for drive 0 and drive 1 on the floppy disk interface. It then makes this information available to the Floppy Disk Controller.</A><p>
<pre>
<A NAME="U531693"></A>
<A NAME="U531644"></A><A NAME="REF25103">Table 62. Tape Drive Assignment Values</A> 
========================
<A NAME="U531648">Bit 1,0</A> |<A NAME="U531650">Drive Selected</A> 
========|===============
<A NAME="U531652">00</A>      |<A NAME="U531654">None</A>           
--------|---------------
<A NAME="U531656">01</A>      |<A NAME="U531662">1</A>              
--------|---------------
<A NAME="U531664">10</A>      |<A NAME="U531668">2</A>              
--------|---------------
<A NAME="U531670">11</A>      |<A NAME="U531672">3</A>              
        |               
========================
</pre>
<A NAME="U538719"></A><H3><A NAME="HDR7">3.4.5  Main Status Register (MSR)</A></H3>
<pre>
<A NAME="U538722">Table 63. Main Status Register (MSR) Characteristics</A> 
===========================================================================================
<A NAME="U538736">Register </A> |<A NAME="U538739">Register</A>   |<A NAME="U538742">Associated </A>  |<A NAME="U538745">Offset </A> |<A NAME="U538748">Read/Write</A>      |<A NAME="U538751">Value when OF </A> |<A NAME="U538753">Software </A>   
<A NAME="U538737">Size</A>      |<A NAME="U538740">Addressing</A> |<A NAME="U538743">Reg Property</A> |<A NAME="U538746">Address</A> |<A NAME="U538749">Characteristics</A> |passes to SW   |<A NAME="U538754">Reset Value</A> 
==========|===========|=============|========|================|===============|============
<A NAME="U538756">1 byte</A>    |<A NAME="U538758">Direct</A>     |<A NAME="U538760">reg[1]</A>       |<A NAME="U538762">0x04</A>    |<A NAME="U538764">Read Only</A>       |<A NAME="U538766">0x00</A>           |<A NAME="U538768">0x00</A>        
          |           |             |        |                |               |            
===========================================================================================
</pre>
<A NAME="U538628">This read-only register facilitates the transfer of data between the system microprocessor and the controller.</A><p>
<pre>
<A NAME="U531806">Table 64. Diskette Drive Controller Status Register</A> 
===========================================================================================================================================
<A NAME="U531814">Bit</A> |<A NAME="U531816"> Function</A>                                                                                                   |<A NAME="U531818">Value when </A>   |<A NAME="U531820">Value on </A> 
    |                                                                                                            |OF passes to  |Software  
    |                                                                                                            |SW            |Reset     
====|============================================================================================================|==============|==========
<A NAME="U531822">7</A>   |<A NAME="U531824"><B>Request for Master: </B>When this bit is 1, the Data register is ready to transfer data with the system micro-</A>  |<A NAME="U531826">0</A>             |<A NAME="U531828">0</A>         
    |processor                                                                                                   |              |          
----|------------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U531830">6</A>   |<A NAME="U531832">Data Input/Output: This bit indicates the direction of data transfer between the diskette drive controller </A> |<A NAME="U531834">0</A>             |<A NAME="U531836">0</A>         
    |and the system microprocessor. When this bit is 1, the transfer is to the system microprocessor; when the   |              |          
    |bit is 0, the transfer is to the controller                                                                 |              |          
----|------------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U531838">5</A>   |<A NAME="U531840"><B>Non-DMA Mode: </B>When this bit is 1, the controller is in the non-DMA mode</A>                                     |<A NAME="U531842">0</A>             |<A NAME="U531844">0</A>         
----|------------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U531846">4</A>   |<A NAME="U531848">Command in Progress: When this bit is 1, command is being processed.</A>                                        |<A NAME="U531850">0</A>             |<A NAME="U531852">0</A>         
----|------------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U531854">3</A>   |<A NAME="U531856"><B>Drive 3 Busy:</B> When this bit is 1, diskette drive 3 is in the seek mode.</A>                                     |<A NAME="U531858">0</A>             |<A NAME="U531860">0</A>         
----|------------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U531862">2</A>   |<A NAME="U531864">Drive 2 Busy: When this bit is 1, diskette drive 2 is in the seek mode</A>                                      |<A NAME="U531866">0</A>             |<A NAME="U531868">0</A>         
----|------------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U531870">1</A>   |<A NAME="U531872"><B>Drive 1 Busy:</B> When this bit is 1, diskette drive 1 is in the seek mode</A>                                      |<A NAME="U531874">0</A>             |<A NAME="U531876">0</A>         
----|------------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U531878">0</A>   |<A NAME="U531880">Drive 0 Busy: When this bit is 1, diskette drive 0 is in the seek mode</A>                                      |<A NAME="U531882">0</A>             |<A NAME="U531884">0</A>         
    |                                                                                                            |              |          
===========================================================================================================================================
</pre>
<A NAME="U516899"></A><H3><A NAME="HDR8">3.4.6  Data Rate Select Register (DRS)</A></H3>
<pre>
<A NAME="U533698">Table 65. Data Rate Select Register (DRS) Characteristics</A> 
=============================================================================================
<A NAME="U533712">Register </A> |<A NAME="U533715">Register</A>   |<A NAME="U533718">Associated </A>  |<A NAME="U533721">Offset </A> |<A NAME="U533724">Read/Write</A>      |<A NAME="U533727">Value when OF </A> |<A NAME="U533730">Software </A>     
<A NAME="U533713">Size</A>      |<A NAME="U533716">Addressing</A> |<A NAME="U533719">Reg Property</A> |<A NAME="U533722">Address</A> |<A NAME="U533725">Characteristics</A> |passes to SW   |<A NAME="U533731">Reset Value</A>   
==========|===========|=============|========|================|===============|==============
<A NAME="U533733">1 byte</A>    |<A NAME="U533735">Direct</A>     |<A NAME="U533737">reg[1]</A>       |<A NAME="U533739">0x04</A>    |<A NAME="U533741">Write Only</A>      |<A NAME="U533743">See<A HREF="floppy5.mak.html#REF91869">Table 66 </A>   </A>|<A NAME="U533745">See <A HREF="floppy5.mak.html#REF91869">Table 66 </A> </A>
          |           |             |        |                |<A HREF="floppy5.mak.html#REF91869">on page 38</A>     |<A HREF="floppy5.mak.html#REF91869">on page 38</A>    
          |           |             |        |                |               |              
=============================================================================================
</pre>
<A NAME="U533694">This write-only register is used to select the data rate and precompensation value for each data rate.</A><p>
<pre>
<A NAME="U536565"></A>
<A NAME="U536566"></A><A NAME="REF91869">Table 66. Precompensation Select Register</A> 
=====================================================================================================================================
<A NAME="U536570">Bit</A> |<A NAME="U536572"> Function</A>                                                                                          |<A NAME="U536622">Value when </A>   |<A NAME="U536631">Software </A>    
    |                                                                                                   |OF passes to  |<A NAME="U536632">Reset Value</A>  
    |                                                                                                   |SW            |             
====|===================================================================================================|==============|=============
<A NAME="U536574">7</A>   |<A NAME="U536576">S/W Reset: This bit functions the same as the POR Reset bit, except it is self clearing.</A>           |<A NAME="U536598">0</A>             |<A NAME="U536612">Not effected</A> 
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U536578">6</A>   |<A NAME="U536580">Low Power: This bit puts the floppy disk controller into low power mode. What low power </A>           |<A NAME="U536600">0</A>             |<A NAME="U536614">Not effected</A> 
    |means can vary from manufacturer to manufacturer. The floppy disk controller comes out of low      |              |             
    |power mode after a software reset, or access to the Data Register or Main Status Register.         |              |             
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U536582">5</A>   |<A NAME="U536584">Reserved: Must be Set to 0.</A>                                                                        |<A NAME="U536602">0</A>             |<A NAME="U536616">Not effected</A> 
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U536586">4-2</A> |<A NAME="U536685">Precompensation Select: These bits select the amount of write precompensation the floppy disk </A>     |<A NAME="U536604">0</A>             |<A NAME="U536618">Not effected</A> 
    |controller uses when writing bits to the floppy disk drive. <A HREF="floppy5.mak.html#REF42613">Table 67 on page 38</A> shows the precom-  |              |             
    |pensation values for each bit encoding. <A HREF="floppy5.mak.html#REF15412">Table 69 on page 39</A> shows the default precompensation      |              |             
    |values for each data rate.                                                                         |              |             
----|---------------------------------------------------------------------------------------------------|--------------|-------------
<A NAME="U536590">1-0</A> |<A NAME="U536592">Data Rate Select: These bits set the data rate of the floppy disk controller. <A HREF="floppy5.mak.html#REF15412">Table 69 on page 39</A> </A> |<A NAME="U536606">0</A>             |<A NAME="U536620">Not effected</A> 
    |shows how data rates for the floppy disk controller are encoded                                    |              |             
=====================================================================================================================================
</pre>
<pre>
<A NAME="U531942"></A>
<A NAME="U531943"></A><A NAME="REF42613">Table 67. Precompensation Values</A> 
========================
<A NAME="U531947">Bits</A>  |<A NAME="U531950">Precompensation </A> 
<A NAME="U531948">4 3 2</A> |<A NAME="U531951">Delay</A>            
======|=================
<A NAME="U531953">000</A>   |<A NAME="U531955">Default</A>          
------|-----------------
<A NAME="U531957">001</A>   |<A NAME="U531959">41.7 ns</A>          
------|-----------------
<A NAME="U531961">010</A>   |<A NAME="U531963">83.3 ns</A>          
------|-----------------
<A NAME="U531965">011</A>   |<A NAME="U531967">125.0 ns</A>         
------|-----------------
<A NAME="U531969">100</A>   |<A NAME="U531971">166.7 ns</A>         
------|-----------------
<A NAME="U531973">101</A>   |<A NAME="U531975">208.3 ns</A>         
------|-----------------
<A NAME="U531977">110</A>   |<A NAME="U531979">250 ns</A>           
------|-----------------
<A NAME="U531981">111</A>   |<A NAME="U531983">0.0 ns</A>           
      |                 
========================
</pre>
<pre>
<A NAME="U532201"></A>
<A NAME="U532202"></A><A NAME="REF15412">Table 68. Default Precompensation Values</A> 
===========================
<A NAME="U532206">Transfer </A> |<A NAME="U532208">Default</A>         
Rate      |<A NAME="U532209">Precompensation</A> 
==========|================
<A NAME="U532211">500Kbps</A>   |<A NAME="U532213">125ns</A>           
----------|----------------
<A NAME="U532215">300Kbps</A>   |<A NAME="U532217">125ns</A>           
----------|----------------
<A NAME="U532219">250Kbps</A>   |<A NAME="U532221">125ns</A>           
----------|----------------
<A NAME="U532223">1000Kbps</A>  |<A NAME="U532225">41.7ns</A>          
          |                
===========================
</pre>
<pre>
<A NAME="U532139"></A>
<A NAME="U532140"></A><A NAME="REF15412">Table 69. Data Rate Select Encodings</A> 
=========================
<A NAME="U532146">Bits</A> |<A NAME="U532149">Data Rate</A>          
     |-------------------
<A NAME="U532147">1 0</A>  |<A NAME="U532186">MFM</A>      |<A NAME="U532188">FM</A>       
=====|=========|=========
<A NAME="U532154">00</A>   |<A NAME="U532156">500Kbps</A>  |<A NAME="U532158">250 Kbps</A> 
-----|---------|---------
<A NAME="U532160">01</A>   |<A NAME="U532162">300Kbps</A>  |<A NAME="U532164">150 Kbps</A> 
-----|---------|---------
<A NAME="U532166">10</A>   |<A NAME="U532168">250 Kbps</A> |<A NAME="U532170">125 Kbps</A> 
-----|---------|---------
<A NAME="U532172">11</A>   |<A NAME="U532174">1 Mbps</A>   |<A NAME="U532176">Illegal</A>  
     |         |         
=========================
</pre>
<A NAME="U516932"></A><H3><A NAME="HDR9">3.4.7  Data Register (FIFO)</A></H3>
<pre>
<A NAME="U533754">Table 70. Data Register (FIFO) Characteristics</A> 
===========================================================================================
<A NAME="U533768">Register </A> |<A NAME="U533771">Register</A>   |<A NAME="U533774">Associated </A>  |<A NAME="U533777">Offset </A> |<A NAME="U533780">Read/Wrt</A>        |<A NAME="U533783">Value when OF </A> |<A NAME="U533786">Software </A>   
<A NAME="U533769">Size</A>      |<A NAME="U533772">Addressing</A> |<A NAME="U533775">Reg Property</A> |<A NAME="U533778">Address</A> |<A NAME="U533781">Characteristics</A> |passes to SW   |<A NAME="U533787">Reset Value</A> 
==========|===========|=============|========|================|===============|============
<A NAME="U533789">1 byte</A>    |<A NAME="U533791">Direct</A>     |<A NAME="U533793">reg[1]</A>       |<A NAME="U533795">0x05</A>    |<A NAME="U533797">Read/Write</A>      |<A NAME="U533799">0x00</A>           |<A NAME="U533801">0x00</A>        
          |           |             |        |                |               |            
===========================================================================================
</pre>
<A NAME="U533750">The FIFO (read/write) is used to transfer all commands, data and status between the system and the floppy disk controller. During the command phase, the system writes the command bytes into the FIFO after polling the RQM and DIO bits in the MSR. During the result phase, the system reads the result bytes from the FIFO after polling the RQM and DIO bits in the MSR.</A><p>
<A NAME="U532268">Enabling the FIFO, and setting the FIFO threshold, is done via the Configure command. If the FIFO is enabled, only the execution phase byte transfers use the 16 byte FIFO. The FIFO is always disabled during the command and result phases of a controller operation. If the FIFO is enabled, it is not disabled after a software reset if the LOCK bit is set in the lock command. After a hardware reset, the FIFO is disabled to maintain compatibility with PC-AT systems.</A><p>
<A NAME="U532269">The 16-byte FIFO can be used for DMA, Interrupt, or software polling type transfers during the execution of a read, write, format, or scan command. In addition, the FIFO can be put into a burst or non-burst mode with the mode command. In the burst mode, DRQ or IRQ remains active until all of the bytes have been transferred to or from the FIFO. In the non-burst mode, DRQ or IRQ is deasserted for 350 ns to allow higher priority transfer requests to be serviced. The mode command can also disable the FIFO for either reads or writes separately. The FIFO allows the system a larger latency without causing a disk overrun/underrun error. Typical uses of the FIFO are at the 1 Mbit/s data rate, or with multi-tasking operating systems. The default state of the FIFO is disabled, with a threshold of zero. The default state is entered after a hardware reset. </A><p>
<A NAME="U532270">During the execution phase of a command involving data transfer to/from the FIFO, the software must respond to a data transfer service request based on the following formula:</A><p>
<A HREF="floppy5.mak.figure.id.1.ps"><img src="floppy5.mak.figure.id.1.gif"></A><p>
<A NAME="U532275">This formula is good for all data rates with the FIFO enabled or disabled. THRESH is a four bit value programmed in the configure command, which sets the FIFO threshold. If the FIFO is disabled, THRESH is zero in the above formula. The last term of the formula, (16xTICP) is an inherent delay due to the microcode overhead required by the FDC. This delay is also data rate dependent.</A><p>
<A NAME="U532377">The programmable FIFO threshold (THRESH) is useful in adjusting the floppy controller to the speed of the system. In other words, a slow system with a sluggish DMA transfer service request (DRQ for DMA mode or IRQ for interrupt mode). Conversely, a fast system with quick response to a data transfer service request uses a low value of THRESH.</A><p>
<A NAME="U537047"><A HREF="floppy5.mak.html#REF22038">Table 71 on page 40</A> is a table of TDRP and TICP values.</A><p>
<A NAME="U537205">TDRP - Data Rate Period</A><p>
<A NAME="U537206">TICP - Internal Clock Period</A><p>
<A NAME="U537207">TCP - Clock Period</A><p>
<pre>
<A NAME="U537848"></A>
<A NAME="U537112"></A><A NAME="REF22038">Table 71. Floppy FIFO Table</A> 
==================================================
<A NAME="U537120">MFM Data Rate</A> |<A NAME="U537123">TDRP</A> |<A NAME="U537126">TICP</A>    |<A NAME="U537129">Example TICP Values</A> 
==============|=====|========|====================
<A NAME="U537132">1 Mbps</A>        |<A NAME="U537134">1000</A> |<A NAME="U537136">3 X TCP</A> |<A NAME="U537138">125 ns</A>              
--------------|-----|--------|--------------------
<A NAME="U537164">500 Kbps</A>      |<A NAME="U537166">2000</A> |<A NAME="U537168">3 X TCP</A> |<A NAME="U537170">125 ns</A>              
--------------|-----|--------|--------------------
<A NAME="U537156">300 Kbps</A>      |<A NAME="U537158">3333</A> |<A NAME="U537160">5 X TCP</A> |<A NAME="U537162">208 ns</A>              
--------------|-----|--------|--------------------
<A NAME="U537148">250 Kbps</A>      |<A NAME="U537150">4000</A> |<A NAME="U537152">6 X TCP</A> |<A NAME="U537154">250 ns</A>              
              |     |        |                    
==================================================
</pre>
<A NAME="U537045"></A><H3><A NAME="HDR10">3.4.8  Digital Input Register (DIR)</A></H3>
<pre>
<A NAME="U533816">Table 72. Digital Input Register (DIR) Characteristics</A> 
=============================================================================================
<A NAME="U533830">Register </A> |<A NAME="U533833">Register</A>   |<A NAME="U533836">Associated </A>  |<A NAME="U533839">Offset </A> |<A NAME="U533842">Read/Write</A>      |<A NAME="U533845">Value when OF </A> |<A NAME="U533848">Software </A>     
<A NAME="U533831">Size</A>      |<A NAME="U533834">Addressing</A> |<A NAME="U533837">Reg Property</A> |<A NAME="U533840">Address</A> |<A NAME="U533843">Characteristics</A> |passes to SW   |<A NAME="U533849">Reset Value</A>   
==========|===========|=============|========|================|===============|==============
<A NAME="U533851">1 byte</A>    |<A NAME="U533853">Direct</A>     |<A NAME="U533855">reg[2]</A>       |<A NAME="U533857">0x00</A>    |<A NAME="U533859">Read Only</A>       |<A NAME="U533861">See <A HREF="floppy5.mak.html#REF39642">Table 73 </A>  </A>|<A NAME="U533863">See <A HREF="floppy5.mak.html#REF39642">Table 73 </A> </A>
          |           |             |        |                |<A HREF="floppy5.mak.html#REF39642">on page 40</A>     |<A HREF="floppy5.mak.html#REF39642">on page 40</A>    
          |           |             |        |                |               |              
=============================================================================================
</pre>
<pre>
<A NAME="U536716"></A>
<A NAME="U532383"></A><A NAME="REF39642">Table 73. Diskette Drive Controller Status Register</A> 
===================================================================================================================================
<A NAME="U532391">Bit</A> |<A NAME="U532393"> Function</A>                                                                                           |<A NAME="U532395">Value when </A>   |<A NAME="U532397">Value on </A> 
    |                                                                                                    |OF passes to  |Software  
    |                                                                                                    |SW            |Reset     
====|====================================================================================================|==============|==========
<A NAME="U532399">7</A>   |<A NAME="U532401"><B>Disk In Place:</B> When this bit is a 1 it reflects that the disk is in place.</A>                          |<A NAME="U532403">x</A>             |<A NAME="U532405">x</A>         
----|----------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U532407">6-3</A> |<A NAME="U532409"><B>Reserved.</B> Must be set to 0b0000.</A>                                                                    |<A NAME="U532411">x</A>             |<A NAME="U532413">x</A>         
----|----------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U532439">2,1</A> |<A NAME="U532441"><B>Data Rate Select:</B> These bits indicate the status of the DRATE1-0 bits programmed throught the </A>      |<A NAME="U532443">x</A>             |<A NAME="U532445">x</A>         
    |DSR or CCR                                                                                          |              |          
----|----------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U532455">0</A>   |<A NAME="U532457"><B>(-High Density):</B> This bit is a 0 when the 1 Mb/s or 500 Kbps data rate is chosen, and a 1 when the </A> |<A NAME="U532459">x</A>             |<A NAME="U532461">x</A>         
    |300 Kbps or 250 Kbps data rate is chosen.                                                           |              |          
===================================================================================================================================
</pre>
<A NAME="U516947"></A><H3><A NAME="HDR11">3.4.9  Configuration Control Register (CCR)</A></H3>
<pre>
<A NAME="U533873">Table 74. Configuration Control Register (CCR) Characteristics</A> 
=============================================================================================
<A NAME="U533887">Register </A> |<A NAME="U533890">Register</A>   |<A NAME="U533893">Associated </A>  |<A NAME="U533896">Offset </A> |<A NAME="U533899">Read/Wrt</A>        |<A NAME="U533902">Value when OF </A> |<A NAME="U533905">Software </A>     
<A NAME="U533888">Size</A>      |<A NAME="U533891">Addressing</A> |<A NAME="U533894">Reg Property</A> |<A NAME="U533897">Address</A> |<A NAME="U533900">Characteristics</A> |passes to SW   |<A NAME="U533906">Reset Value</A>   
==========|===========|=============|========|================|===============|==============
<A NAME="U533908">1 byte</A>    |<A NAME="U533910">Direct</A>     |<A NAME="U533912">reg[2]</A>       |<A NAME="U533914">0x00</A>    |<A NAME="U533916">Write Only</A>      |<A NAME="U533918">See <A HREF="floppy5.mak.html#REF76896">Table 75 </A>  </A>|<A NAME="U533920">See <A HREF="floppy5.mak.html#REF76896">Table 75 </A> </A>
          |           |             |        |                |<A HREF="floppy5.mak.html#REF76896">on page 41</A>     |<A HREF="floppy5.mak.html#REF76896">on page 41</A>    
          |           |             |        |                |               |              
=============================================================================================
</pre>
<A NAME="U533869">This write-only register sets the transfer rate.</A><p>
<pre>
<A NAME="U537698"></A>
<A NAME="U520765"></A><A NAME="REF76896">Table 75. Data Rate Control Register</A> 
=====================================================================================================================
<A NAME="U518841">Bit</A> |<A NAME="U518843"> Function</A>                                                                             |<A NAME="U532552">Value when </A>   |<A NAME="U532562">Value on </A> 
    |                                                                                      |OF passes to  |Software  
    |                                                                                      |SW            |Reset     
====|======================================================================================|==============|==========
<A NAME="U518845">7-2</A> |<A NAME="U518847"><B> Reserved: </B>Must be 0</A>                                                                  |<A NAME="U532554">x</A>             |<A NAME="U532564">x</A>         
----|--------------------------------------------------------------------------------------|--------------|----------
<A NAME="U518849">1</A>   |<A NAME="U518851"><B> Data Rate Select:</B> Bits 1-0 select the data rate, as shown in the <A HREF="floppy5.mak.html#REF32752">Table 76 on page 41</A></A> |<A NAME="U532556">1</A>             |<A NAME="U532566">1</A>         
----|--------------------------------------------------------------------------------------|--------------|----------
<A NAME="U518853">0</A>   |<A NAME="U518855"><B> Data Rate Select:</B> Bits 1-0 select the data rate, as shown in the <A HREF="floppy5.mak.html#REF32752">Table 76 on page 41</A></A> |<A NAME="U532558">0</A>             |<A NAME="U532568">0</A>         
    |                                                                                      |              |          
=====================================================================================================================
</pre>
<A NAME="U534222"></A><pre>
<A NAME="U532587"></A>
<A NAME="U520769"></A><A NAME="REF32752">Table 76. Data Rate Selection</A> 
=================================
<A NAME="U518890">Bits</A> |<A NAME="U518892">Data Rate</A>                  
<A NAME="U518908">1 0</A>  |                           
=====|===========================
<A NAME="U518894">00</A>   |<A NAME="U518896">500,000 bits per second</A>    
-----|---------------------------
<A NAME="U518898">01</A>   |<A NAME="U518900">300,000 bits per second</A>    
-----|---------------------------
<A NAME="U518902">10</A>   |<A NAME="U518904">250,000 bits per second</A>    
-----|---------------------------
<A NAME="U518931">11</A>   |<A NAME="U518933">1,000,000 bits per second*</A> 
     |                           
=================================
</pre>
<A NAME="U538919"></A><A NAME="U534274"></A><H3><A NAME="REF33824">3.4.10  Autoeject Register (AEJ)</A></H3>
<pre>
<A NAME="U534226">Table 77. Autoeject Register (AEJ) Characteristics</A> 
===========================================================================================
<A NAME="U534240">Register </A> |<A NAME="U534243">Register</A>   |<A NAME="U534246">Associated </A>  |<A NAME="U534249">Offset </A> |<A NAME="U534252">Read/Write</A>      |<A NAME="U534255">Value when OF </A> |<A NAME="U534258">Software </A>   
<A NAME="U534241">Size</A>      |<A NAME="U534244">Addressing</A> |<A NAME="U534247">Reg Property</A> |<A NAME="U534250">Address</A> |<A NAME="U534253">Characteristics</A> |passes to SW   |<A NAME="U534259">Reset Value</A> 
==========|===========|=============|========|================|===============|============
<A NAME="U534261">1 byte</A>    |<A NAME="U534263">Direct</A>     |<A NAME="U534265">reg[3]</A>       |<A NAME="U534267">0x00</A>    |<A NAME="U534269">Read/Write</A>      |<A NAME="U534271">0x00</A>           |<A NAME="U534273">0x00</A>        
          |           |             |        |                |               |            
===========================================================================================
</pre>
<A NAME="U534275">This table is provided for systems that optionally support floppy disk auto-eject.</A><p>
<A NAME="U534276">The motor must be stopped before doing an eject. To cause an auto-eject, software must write to the least significant bit of this register with a 1, followed by a pause provided by software of at least 10 microseconds, followed by a write of a 0, which will result in the auto-eject. All other bits in this register are reserved, therefore software must use a read-modify-write.</A><p>
<A NAME="U533251"></A><H2><A NAME="HDR12">3.5  Floppy Drive Controller Programming Considerations</A></H2>
<A NAME="U516966">Each command is initiated by a multibyte transfer from the system microprocessor; the result can be a multibyte transfer back to the system microprocessor. Most transfers consist of three phases:</A><p>

<UL>
<A NAME="U516967"><LI><I>Command Phase: </I>The system microprocessor writes a series of command bytes to the controller directing it to perform a specific operation.</A><BR>

<A NAME="U516968"><LI><I>Execution Phase: </I>The controller performs the specified operation.</A><BR>

<A NAME="U516969"><LI><I>Result Phase: </I>After the operation is complete, status information is available to the system microprocessor through a sequence of read commands.</A><BR>
</UL>


<A NAME="U516970">The Seek, Relative Seek, and Recalibrate commands have no result phase. After issuing these commands, the Sense Interrupt Status command must be issued for proper termination and verification of the head position (Present Cylinder Number parameter or PCN).</A><p>
<A NAME="U516974"></A><H3><A NAME="HDR13">3.5.1  Controller Commands</A></H3>
<H3><A NAME="U534290">Requirements:</A></H3>

<DL>
<A NAME="U534297"><DD>3-13.  For the device described herein, the commands described in <A HREF="floppy5.mak.html#REF18839">Section 3.5.1.1, "Configure Command," on page 43</A> through <A HREF="floppy5.mak.html#REF38677">Section 3.5.1.22, "Write Deleted Data Command," on page 55</A> must be implemented as specified.</A><BR>
</DL>


<A NAME="U534288">The following are supported commands for diskette drive controller:</A><p>

<UL>
<A NAME="U516976"><LI>Configure</A><BR>

<A NAME="U516977"><LI>Dumpreg</A><BR>

<A NAME="U516978"><LI>Format Track</A><BR>

<A NAME="U532926"><LI>Lock</A><BR>

<A NAME="U532928"><LI>Perpendicular Mode</A><BR>

<A NAME="U516979"><LI>Read Data</A><BR>

<A NAME="U516980"><LI>Read Deleted Data</A><BR>

<A NAME="U516981"><LI>Read ID</A><BR>

<A NAME="U516982"><LI>Read Track</A><BR>

<A NAME="U516983"><LI>Recalibrate</A><BR>

<A NAME="U516984"><LI>Relative Seek</A><BR>

<A NAME="U516985"><LI>Scan Equal</A><BR>

<A NAME="U516986"><LI>Scan High or Equal</A><BR>

<A NAME="U516987"><LI>Scan Low or Equal</A><BR>

<A NAME="U516988"><LI>Seek</A><BR>

<A NAME="U516989"><LI>Sense Drive Status</A><BR>

<A NAME="U516990"><LI>Sense Interrupt Status</A><BR>

<A NAME="U516991"><LI>Specify</A><BR>

<A NAME="U516992"><LI>Verify</A><BR>

<A NAME="U516993"><LI>Version</A><BR>

<A NAME="U516994"><LI>Write Data</A><BR>

<A NAME="U516995"><LI>Write Deleted Data.</A><BR>

<A NAME="U538642"><LI>Invalid Command Status</A><BR>
<A NAME="U534300"></A></UL>


<A NAME="U517130"></A><H4><A NAME="REF18839">3.5.1.1  Configure Command</A></H4>
<H5><A NAME="U517131">3.5.1.1.1  Command Phase</A></H5>
<pre>
<A NAME="U520608">Table 78. Configure Command Phase</A> 
===========================================
       |<A NAME="U520628">7</A>  |<A NAME="U520630">6</A>   |<A NAME="U520632">5</A>   |<A NAME="U520634">4</A>  |<A NAME="U520636">3</A>       |<A NAME="U520638">2</A> |<A NAME="U520640">1</A> |<A NAME="U520642">0</A> 
-------|---|----|----|---|--------|--|--|--
<A NAME="U520644">Byte 0</A> |<A NAME="U520646">0</A>  |<A NAME="U520648">0</A>   |<A NAME="U520650">0</A>   |<A NAME="U520652">1</A>  |<A NAME="U520654">0</A>       |<A NAME="U520656">0</A> |<A NAME="U520658">1</A> |<A NAME="U520660">1</A> 
=======|===|====|====|===|========|==|==|==
<A NAME="U520662">Byte 1</A> |<A NAME="U520664"> 0</A> |<A NAME="U520666">0</A>   |<A NAME="U520668">0</A>   |<A NAME="U520670">0</A>  |<A NAME="U520672">0</A>       |<A NAME="U520674">0</A> |<A NAME="U520676">0</A> |<A NAME="U520678">0</A> 
-------|---|----|----|---|--------|--|--|--
<A NAME="U520680">Byte 2</A> |<A NAME="U520682">0</A>  |<A NAME="U520684">EIS</A> |<A NAME="U520686">EFF</A> |<A NAME="U520688">PD</A> |<A NAME="U520690">Thresh-</A> |  |  |  
       |   |    |    |   |old     |  |  |  
       |   |    |    |   |(THR)   |  |  |  
-------|---|----|----|---|--------|--|--|--
<A NAME="U520698">Byte 3</A> |<A NAME="U520700">Precompensation Track Number (PTN)</A>                        
       |                                   
===========================================
</pre>
<H5><A NAME="U532930">3.5.1.1.2  Execution Phase</A></H5>
<A NAME="U517137">Internal registers are read.</A><p>
<H5><A NAME="U517138">3.5.1.1.3  Result Phase</A></H5>
<A NAME="U520821">This command has no result phase.</A><p>
<A NAME="U534016"></A><A NAME="U517141"></A><H4><A NAME="REF40799">3.5.1.2  Dumpreg Command</A></H4>
<H5><A NAME="U517142">3.5.1.2.1  Command Phase</A></H5>
<pre>
<A NAME="U535724">Table 79. Dumpreg Command Phase</A> 
=======================================
       |<A NAME="U529855">7</A>  |<A NAME="U529857"> 6</A> |<A NAME="U529859"> 5</A> |<A NAME="U529861"> 4</A> |<A NAME="U529863"> 3</A> |<A NAME="U529865"> 2</A> |<A NAME="U529867"> 1</A> |<A NAME="U529869"> 0</A> 
=======|===|===|===|===|===|===|===|===
<A NAME="U529871">Byte 0</A> |<A NAME="U529873"> 0</A> |<A NAME="U529875"> 0</A> |<A NAME="U529877"> 0</A> |<A NAME="U529879"> 0</A> |<A NAME="U529881"> 1</A> |<A NAME="U529883"> 1</A> |<A NAME="U529885"> 1</A> |<A NAME="U529887"> 0</A> 
       |   |   |   |   |   |   |   |   
=======================================
</pre>
<H5><A NAME="U532933">3.5.1.2.2  Execution Phase</A></H5>
<A NAME="U532934">Internal registers are written.</A><p>
<H5><A NAME="U532931">3.5.1.2.3  Result Phase</A></H5>
<pre>
<A NAME="U520838">Table 80. Dumpreg Result Phase</A> 
=================================================
       |<A NAME="U520858">7</A> |<A NAME="U520860">6</A>    |<A NAME="U520862">5</A>    |<A NAME="U520864">4</A>  |<A NAME="U520866">3</A> |<A NAME="U520868">2</A> |<A NAME="U520870">1</A>   |<A NAME="U520872">0</A>     
=======|==|=====|=====|===|==|==|====|===========
<A NAME="U520892">Byte 0</A> |<A NAME="U520894">Present Track Number - Drive 0</A>                            
-------|-----------------------------------------
<A NAME="U521417">Byte 1</A> |<A NAME="U521419">Present Track Number - Drive 1</A>                            
-------|-----------------------------------------
<A NAME="U520910">Byte 2</A> |<A NAME="U520912">Present Track Number - Drive 2</A>                            
-------|-----------------------------------------
<A NAME="U520928">Byte 3</A> |<A NAME="U520930">Present Track Number - Drive 3</A>                            
-------|-----------------------------------------
<A NAME="U520946">Byte 4</A> |<A NAME="U520948">Stepping Rate Time Head Unload Time</A>                        
-------|-----------------------------------------
<A NAME="U520964">Byte 5</A> |<A NAME="U520966">Head Load Time</A>               |<A NAME="U521042">DMA</A>   
-------|-----------------------------|-----------
<A NAME="U520982">Byte 6</A> |<A NAME="U520984">Number of Sectors per Track/End of Track</A>                  
-------|-----------------------------------------
<A NAME="U521000">Byte 7</A> |<A NAME="U521002">X</A> |<A NAME="U521004">0</A>    |<A NAME="U521006">Reserved</A>    |<A NAME="U521049">X</A> |<A NAME="U521051">GAP</A> |<A NAME="U521053">WGATE</A> 
-------|--|-----|------------|--|----|-----------
<A NAME="U521018">Byte 8</A> |<A NAME="U521020">O</A> |<A NAME="U521022"> EIS</A> |<A NAME="U521024"> EFF</A> |<A NAME="U521026">PD</A> |<A NAME="U521028"> Threshold</A>               
-------|--|-----|-----|---|----------------------
<A NAME="U521055">Byte 9</A> |<A NAME="U521057">Precompensation Track Number</A>                              
       |                                    
=================================================
</pre>
<A NAME="U517160"></A><H4><A NAME="HDR14">3.5.1.3  Format Track Command</A></H4>
<H5><A NAME="U532943">3.5.1.3.1  Command Phase</A></H5>
<pre>
<A NAME="U521237">Table 81. Format Command Phase</A> 
============================================
       |<A NAME="U521257">7</A>  |<A NAME="U521259"> 6</A>   |<A NAME="U521261"> 5</A> |<A NAME="U521263"> 4</A> |<A NAME="U521265"> 3</A> |<A NAME="U521267"> 2</A>  |<A NAME="U521269"> 1</A>  |<A NAME="U521271"> 0</A>  
=======|===|=====|===|===|===|====|====|====
<A NAME="U521273">Byte 0</A> |<A NAME="U521275"> 0</A> |<A NAME="U521277"> MFM</A> |<A NAME="U521279"> 0</A> |<A NAME="U521281"> 0</A> |<A NAME="U521283">1</A>  |<A NAME="U521285">1</A>   |<A NAME="U521287">0</A>   |<A NAME="U521289">1</A>   
-------|---|-----|---|---|---|----|----|----
<A NAME="U521291">Byte 1</A> |<A NAME="U521293">0</A>  |<A NAME="U521295"> 0</A>   |<A NAME="U521297"> 0</A> |<A NAME="U521299"> 0</A> |<A NAME="U521301"> 0</A> |<A NAME="U521303"> HD</A> |<A NAME="U521305"> US</A> |<A NAME="U521307"> US</A> 
-------|---|-----|---|---|---|----|----|----
<A NAME="U521309">Byte 2</A> |<A NAME="U521311">Number of Data Bytes in Sector</A>                             
-------|------------------------------------
<A NAME="U521327">Byte 3</A> |<A NAME="U521329">Sectors per Track</A>                                 
-------|------------------------------------
<A NAME="U521345">Byte 4</A> |<A NAME="U521347">Gap Length</A>                                 
-------|------------------------------------
<A NAME="U521363">Byte 5</A> |<A NAME="U521365">Fill Byte</A>                                 
       |                                    
============================================
</pre>
<H5><A NAME="U521224">3.5.1.3.2  Execution Phase</A></H5>
<A NAME="U532950">The system transfers four ID bytes (track, head, sector, bytes/sector) per sector to the floppy controller via DMA or Non-DMA modes. The entire track is formatted. The data block in the data field of each sector is filled with the data pattern byte.</A><p>
<H5><A NAME="U521232">3.5.1.3.3  Result Phase</A></H5>
<pre>
<A NAME="U521436">Table 82. Format Result Phase </A> 
===========================
<A NAME="U537711">Byte 0</A> |<A NAME="U537713">Status Register 0</A>  
-------|-------------------
<A NAME="U521444">Byte 1</A> |<A NAME="U521446"> Status Register 1</A> 
-------|-------------------
<A NAME="U521448">Byte 2</A> |<A NAME="U521450"> Status Register 2</A> 
-------|-------------------
<A NAME="U521452">Byte 3</A> |<A NAME="U521454"> Reserved</A>          
-------|-------------------
<A NAME="U521456">Byte 4</A> |<A NAME="U521458"> Reserved</A>          
-------|-------------------
<A NAME="U521460">Byte 5</A> |<A NAME="U521462"> Reserved</A>          
-------|-------------------
<A NAME="U521464">Byte 6</A> |<A NAME="U521466"> Reserved</A>          
       |                   
===========================
</pre>
<A NAME="U517181"></A><H4><A NAME="HDR15">3.5.1.4  Lock Command</A></H4>
<H5><A NAME="U517182">3.5.1.4.1  Command Phase</A></H5>
<pre>
<A NAME="U521488">Table 83. Lock Command Phase</A> 
======================================
       |<A NAME="U521508">7</A>     |<A NAME="U521510"> 6</A> |<A NAME="U521512"> 5</A> |<A NAME="U521514"> 4</A> |<A NAME="U521516">3</A> |<A NAME="U521518">2</A> |<A NAME="U521520">1</A> |<A NAME="U521522">0</A> 
=======|======|===|===|===|==|==|==|==
<A NAME="U521524">Byte 0</A> |<A NAME="U521526"> Lock</A> |<A NAME="U521528"> 0</A> |<A NAME="U521530"> 0</A> |<A NAME="U521532"> 1</A> |<A NAME="U521534">0</A> |<A NAME="U521536">1</A> |<A NAME="U521538">0</A> |<A NAME="U521540">0</A> 
       |      |   |   |   |  |  |  |  
======================================
</pre>
<H5><A NAME="U532951">3.5.1.4.2  Execution Phase</A></H5>
<A NAME="U532952">An internal Register is written.</A><p>
<H5><A NAME="U521479">3.5.1.4.3  Result Phase</A></H5>
<pre>
<A NAME="U521543">Table 84. Lock Result Phase</A> 
=====================================
       |<A NAME="U521563">7</A> |<A NAME="U521565"> 6</A> |<A NAME="U521567"> 5</A> |<A NAME="U521569"> 4</A>    |<A NAME="U521571">3</A> |<A NAME="U521573">2</A> |<A NAME="U521575">1</A> |<A NAME="U521577">0</A> 
=======|==|===|===|======|==|==|==|==
<A NAME="U521579">Byte 0</A> |<A NAME="U521581">0</A> |<A NAME="U521583"> 0</A> |<A NAME="U521585"> 0</A> |<A NAME="U521587"> Lock</A> |<A NAME="U521589">0</A> |<A NAME="U521591">0</A> |<A NAME="U521593">0</A> |<A NAME="U521595">0</A> 
       |  |   |   |      |  |  |  |  
=====================================
</pre>
<A NAME="U532953"></A><H4><A NAME="HDR16">3.5.1.5  Perpendicular Mode Command</A></H4>
<H5><A NAME="U521721">3.5.1.5.1  Command Phase</A></H5>
<pre>
<A NAME="U521605">Table 85. Perpendicular Mode Command Phase</A> 
===========================================
       |<A NAME="U521625">7</A>  |<A NAME="U521627"> 6</A> |<A NAME="U521629"> 5</A> |<A NAME="U521631"> 4</A> |<A NAME="U521633">3</A>  |<A NAME="U521635">2</A>  |<A NAME="U521637">1</A>   |<A NAME="U521639">0</A>     
=======|===|===|===|===|===|===|====|======
<A NAME="U521641">Byte 0</A> |<A NAME="U521643">0</A>  |<A NAME="U521645">0</A>  |<A NAME="U521647">0</A>  |<A NAME="U521649">1</A>  |<A NAME="U521651">0</A>  |<A NAME="U521653">0</A>  |<A NAME="U521655">1</A>   |<A NAME="U521657">0</A>     
-------|---|---|---|---|---|---|----|------
<A NAME="U521744">Byte 1</A> |<A NAME="U521746">OW</A> |<A NAME="U521748">0</A>  |<A NAME="U521750">D3</A> |<A NAME="U521752">D2</A> |<A NAME="U521754">D1</A> |<A NAME="U521756">D0</A> |<A NAME="U521758">GAP</A> |<A NAME="U521760">WGATE</A> 
       |   |   |   |   |   |   |    |      
===========================================
</pre>
<H5><A NAME="U521714">3.5.1.5.2  Execution Phase</A></H5>
<A NAME="U532955">Internal registers are written.</A><p>
<H5><A NAME="U532954">3.5.1.5.3  Result Phase</A></H5>
<A NAME="U521724">There is no result phase for the Perpendicular Mode command.</A><p>
<A NAME="U517189"></A><H4><A NAME="HDR17">3.5.1.6  Read Data Command</A></H4>
<H5><A NAME="U517198">3.5.1.6.1  Command Phase</A></H5>
<pre>
<A NAME="U534909">Table 86. Read Data Command Phase</A> 
=============================================
       |<A NAME="U521811">7</A>   |<A NAME="U521813"> 6</A>   |<A NAME="U521815"> 5</A> |<A NAME="U521817"> 4</A> |<A NAME="U521819"> 3</A> |<A NAME="U521821"> 2</A>  |<A NAME="U521823"> 1</A>  |<A NAME="U521825"> 0</A>  
=======|====|=====|===|===|===|====|====|====
<A NAME="U521827">Byte 0</A> |<A NAME="U521829">MT0</A> |<A NAME="U521831"> MFM</A> |<A NAME="U521833">SK</A> |<A NAME="U521835"> 0</A> |<A NAME="U521837">0</A>  |<A NAME="U521839">1</A>   |<A NAME="U521841">1</A>   |<A NAME="U521843">0</A>   
-------|----|-----|---|---|---|----|----|----
<A NAME="U521845">Byte 1</A> |<A NAME="U521847">0</A>   |<A NAME="U521849"> 0</A>   |<A NAME="U521851"> 0</A> |<A NAME="U521853"> 0</A> |<A NAME="U521855"> 0</A> |<A NAME="U521857"> HD</A> |<A NAME="U521859"> US</A> |<A NAME="U521861"> US</A> 
-------|----|-----|---|---|---|----|----|----
<A NAME="U521863">Byte 2</A> |<A NAME="U521865">Track Number</A>                                 
-------|-------------------------------------
<A NAME="U521881">Byte 3</A> |<A NAME="U521883">Head Address</A>                                 
-------|-------------------------------------
<A NAME="U521899">Byte 4</A> |<A NAME="U521901">Sector Number</A>                                 
-------|-------------------------------------
<A NAME="U521917">Byte 5</A> |<A NAME="U521919">Number of Data Bytes in Sector</A>                             
-------|-------------------------------------
<A NAME="U526909">Byte 6</A> |<A NAME="U526911">End-of-Track</A>                                 
-------|-------------------------------------
<A NAME="U526927">Byte 7</A> |<A NAME="U526929">Gap Length</A>                                 
-------|-------------------------------------
<A NAME="U526945">Byte 8</A> |<A NAME="U526947">Data Length</A>                                 
       |                                     
=============================================
</pre>
<H5><A NAME="U517210">3.5.1.6.2  Execution Phase</A></H5>
<A NAME="U532957">Data read from disk drive is transferred to system via DMA or non-DMA modes.</A><p>
<H5><A NAME="U532956">3.5.1.6.3  Result Phase</A></H5>
<pre>
<A NAME="U534927">Table 87. Read Data Result Phase</A> 
=======================================
<A NAME="U535742">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U521985">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U526978">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U522003">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U522021">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U522039">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U522057">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U522207"></A><H4><A NAME="HDR18">3.5.1.7  Read Deleted Data Command</A></H4>
<H5><A NAME="U522338">3.5.1.7.1  Command Phase</A></H5>
<pre>
<A NAME="U534945">Table 88. Read Deleted Data Command Phase </A> 
============================================
       |<A NAME="U522084">7</A>  |<A NAME="U522086"> 6</A>   |<A NAME="U522088"> 5</A> |<A NAME="U522090"> 4</A> |<A NAME="U522092"> 3</A> |<A NAME="U522094"> 2</A>  |<A NAME="U522096"> 1</A>  |<A NAME="U522098"> 0</A>  
=======|===|=====|===|===|===|====|====|====
<A NAME="U522100">Byte 0</A> |<A NAME="U522102">MT</A> |<A NAME="U522104"> MFM</A> |<A NAME="U522106">SK</A> |<A NAME="U522108">0</A>  |<A NAME="U522110">1</A>  |<A NAME="U522112">1</A>   |<A NAME="U522114">0</A>   |<A NAME="U522116">0</A>   
-------|---|-----|---|---|---|----|----|----
<A NAME="U522118">Byte 1</A> |<A NAME="U522120">0</A>  |<A NAME="U522122"> 0</A>   |<A NAME="U522124"> 0</A> |<A NAME="U522126"> 0</A> |<A NAME="U522128"> 0</A> |<A NAME="U522130"> HD</A> |<A NAME="U522132"> US</A> |<A NAME="U522134"> US</A> 
-------|---|-----|---|---|---|----|----|----
<A NAME="U522136">Byte 2</A> |<A NAME="U522138">Track Number</A>                                 
-------|------------------------------------
<A NAME="U527035">Byte 3</A> |<A NAME="U527037">Head Address</A>                                 
-------|------------------------------------
<A NAME="U522154">Byte 4</A> |<A NAME="U522156">Sector Number</A>                                 
-------|------------------------------------
<A NAME="U522172">Byte 5</A> |<A NAME="U522174">Number of Data Bytes in Sector</A>                             
-------|------------------------------------
<A NAME="U522190">Byte 6</A> |<A NAME="U522192">End-of-Track</A>                                 
-------|------------------------------------
<A NAME="U527068">Byte 7</A> |<A NAME="U527112">Gap Length</A>                                 
-------|------------------------------------
<A NAME="U527086">Byte 8</A> |<A NAME="U527088">Data Length</A>                                 
       |                                    
============================================
</pre>
<H5><A NAME="U522335">3.5.1.7.2  Execution Phase</A></H5>
<A NAME="U532959">Data read from disk drive is transferred to system via DMA or non-DMA modes.</A><p>
<H5><A NAME="U532958">3.5.1.7.3  Result Phase</A></H5>
<pre>
<A NAME="U534963">Table 89. Read Deleted Data Result Phase</A> 
=======================================
<A NAME="U522228">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U522246">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U522264">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U522282">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U522300">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U522318">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U527141">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U522340"></A><H4><A NAME="HDR19">3.5.1.8  Read ID Command</A></H4>
<H5><A NAME="U522468">3.5.1.8.1  Command Phase</A></H5>
<pre>
<A NAME="U534981">Table 90. Read ID Command Phase </A> 
============================================
       |<A NAME="U522345">7</A>  |<A NAME="U522347"> 6</A>   |<A NAME="U522349"> 5</A> |<A NAME="U522351"> 4</A> |<A NAME="U522353"> 3</A> |<A NAME="U522355"> 2</A>  |<A NAME="U522357"> 1</A>  |<A NAME="U522359"> 0</A>  
=======|===|=====|===|===|===|====|====|====
<A NAME="U522361">Byte 0</A> |<A NAME="U522363"> 0</A> |<A NAME="U522365"> MFM</A> |<A NAME="U522367"> 0</A> |<A NAME="U522369"> 0</A> |<A NAME="U522371">1</A>  |<A NAME="U522373">0</A>   |<A NAME="U522375">1</A>   |<A NAME="U522377">0</A>   
-------|---|-----|---|---|---|----|----|----
<A NAME="U522379">Byte 1</A> |<A NAME="U522381">0</A>  |<A NAME="U522383"> 0</A>   |<A NAME="U522385"> 0</A> |<A NAME="U522387"> 0</A> |<A NAME="U522389"> 0</A> |<A NAME="U522391"> HD</A> |<A NAME="U522393"> US</A> |<A NAME="U522395"> US</A> 
       |   |     |   |   |   |    |    |    
============================================
</pre>
<H5><A NAME="U522596">3.5.1.8.2  Execution Phase</A></H5>
<A NAME="U532962">The controller reads the first ID field header bytes it can find and reports these bytes to the system in the result bytes.</A><p>
<H5><A NAME="U532961">3.5.1.8.3  Result Phase</A></H5>
<pre>
<A NAME="U534999">Table 91. Read ID Result Phase </A> 
=======================================
<A NAME="U522489">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U522507">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U522525">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U522543">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U522561">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U522579">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U527183">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U522600"></A><H4><A NAME="HDR20">3.5.1.9  Read Track Command</A></H4>
<H5><A NAME="U522728">3.5.1.9.1  Command Phase</A></H5>
<pre>
<A NAME="U535017">Table 92. Read Track Command Phase </A> 
============================================
       |<A NAME="U522605">7</A>  |<A NAME="U522607"> 6</A>   |<A NAME="U522609"> 5</A> |<A NAME="U522611"> 4</A> |<A NAME="U522613"> 3</A> |<A NAME="U522615"> 2</A>  |<A NAME="U522617"> 1</A>  |<A NAME="U522619"> 0</A>  
=======|===|=====|===|===|===|====|====|====
<A NAME="U522621">Byte 0</A> |<A NAME="U522623"> 0</A> |<A NAME="U522625"> MFM</A> |<A NAME="U522627"> 0</A> |<A NAME="U522629"> 0</A> |<A NAME="U522631">0</A>  |<A NAME="U522633">0</A>   |<A NAME="U522635">1</A>   |<A NAME="U522637">0</A>   
-------|---|-----|---|---|---|----|----|----
<A NAME="U522639">Byte 1</A> |<A NAME="U522641">0</A>  |<A NAME="U522643"> 0</A>   |<A NAME="U522645"> 0</A> |<A NAME="U522647"> 0</A> |<A NAME="U522649"> 0</A> |<A NAME="U522651"> HD</A> |<A NAME="U522653"> US</A> |<A NAME="U522655"> US</A> 
-------|---|-----|---|---|---|----|----|----
<A NAME="U522657">Byte 2</A> |<A NAME="U522659">Track Number</A>                                 
-------|------------------------------------
<A NAME="U522675">Byte 3</A> |<A NAME="U522677">Head Address</A>                                 
-------|------------------------------------
<A NAME="U522693">Byte 4</A> |<A NAME="U522695">Sector Number </A>                                 
-------|------------------------------------
<A NAME="U522711">Byte 5</A> |<A NAME="U522713">Number of Data Bytes in Sector</A>                             
-------|------------------------------------
<A NAME="U527228">Byte 6</A> |<A NAME="U527230">End-of-Track</A>                                 
-------|------------------------------------
<A NAME="U527246">Byte 7</A> |<A NAME="U527248">Gap Length</A>                                 
-------|------------------------------------
<A NAME="U527264">Byte 8</A> |<A NAME="U527266">Data Length</A>                                 
       |                                    
============================================
</pre>
<H5><A NAME="U527427">3.5.1.9.2  Execution Phase</A></H5>
<A NAME="U532964">Data read from the disk drive is transferred to the system via DMA or non-DMA modes.</A><p>
<H5><A NAME="U532963">3.5.1.9.3  Result Phase</A></H5>
<pre>
<A NAME="U535035">Table 93. Read Track Result Phase </A> 
=======================================
<A NAME="U527302">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U527320">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U527338">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U527356">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U527374">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U527392">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U527410">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U527298"></A><H4><A NAME="HDR21">3.5.1.10  Recalibrate Command</A></H4>
<H5><A NAME="U522991">3.5.1.10.1  Command Phase</A></H5>
<pre>
<A NAME="U535053">Table 94. Recalibrate Command Phase </A> 
=========================================
       |<A NAME="U522868">7</A>  |<A NAME="U522870"> 6</A> |<A NAME="U522872"> 5</A> |<A NAME="U522874"> 4</A> |<A NAME="U522876"> 3</A> |<A NAME="U522878"> 2</A> |<A NAME="U522880"> 1</A>  |<A NAME="U522882"> 0</A>  
=======|===|===|===|===|===|===|====|====
<A NAME="U522884">Byte 0</A> |<A NAME="U522886"> 0</A> |<A NAME="U522888">0</A>  |<A NAME="U522890"> 0</A> |<A NAME="U522892"> 0</A> |<A NAME="U522894">0</A>  |<A NAME="U522896">1</A>  |<A NAME="U522898">1</A>   |<A NAME="U522900">1</A>   
-------|---|---|---|---|---|---|----|----
<A NAME="U522902">Byte 1</A> |<A NAME="U522904">0</A>  |<A NAME="U522906"> 0</A> |<A NAME="U522908"> 0</A> |<A NAME="U522910"> 0</A> |<A NAME="U522912"> 0</A> |<A NAME="U522914">0</A>  |<A NAME="U522916"> US</A> |<A NAME="U522918"> US</A> 
       |   |   |   |   |   |   |    |    
=========================================
</pre>
<H5><A NAME="U523119">3.5.1.10.2  Execution Phase</A></H5>
<A NAME="U532966">The disk drive head is stepped out to Track 0.</A><p>
<H5><A NAME="U532965">3.5.1.10.3  Result Phase</A></H5>
<A NAME="U528793">This command has no result phase.</A><p>
<A NAME="U523128"></A><H4><A NAME="HDR22">3.5.1.11  Relative Seek Command</A></H4>
<H5><A NAME="U523256">3.5.1.11.1  Command Phase</A></H5>
<pre>
<A NAME="U535089">Table 95. Relative Seek Command Phase </A> 
===========================================
       |<A NAME="U523133">7</A>  |<A NAME="U523135"> 6</A>  |<A NAME="U523137"> 5</A> |<A NAME="U523139"> 4</A> |<A NAME="U523141"> 3</A> |<A NAME="U523143"> 2</A>  |<A NAME="U523145"> 1</A>  |<A NAME="U523147"> 0</A>  
=======|===|====|===|===|===|====|====|====
<A NAME="U523149">Byte 0</A> |<A NAME="U523151"> 1</A> |<A NAME="U523153">DIR</A> |<A NAME="U523155"> 0</A> |<A NAME="U523157"> 0</A> |<A NAME="U523159">1</A>  |<A NAME="U523161">1</A>   |<A NAME="U523163">1</A>   |<A NAME="U523165">1</A>   
-------|---|----|---|---|---|----|----|----
<A NAME="U523167">Byte 1</A> |<A NAME="U523169">0</A>  |<A NAME="U523171"> 0</A>  |<A NAME="U523173"> 0</A> |<A NAME="U523175"> 0</A> |<A NAME="U523177"> 0</A> |<A NAME="U523179"> HD</A> |<A NAME="U523181"> US</A> |<A NAME="U523183"> US</A> 
-------|---|----|---|---|---|----|----|----
<A NAME="U523185">Byte 2</A> |<A NAME="U523187">Relative Cylinder Number</A>                                
       |                                   
===========================================
</pre>
<H5><A NAME="U523384">3.5.1.11.2  Execution Phase</A></H5>
<A NAME="U532968">The disk drive head is stepped in or out a programmable number of tracks.</A><p>
<H5><A NAME="U532967">3.5.1.11.3  Result Phase</A></H5>
<A NAME="U528812">This command has no result phase.</A><p>
<A NAME="U523393"></A><H4><A NAME="HDR23">3.5.1.12  Scan Equal Command</A></H4>
<H5><A NAME="U523657">3.5.1.12.1  Command Phase</A></H5>
<pre>
<A NAME="U535125">Table 96. Scan Equal Command Phase </A> 
============================================
       |<A NAME="U523398">7</A>  |<A NAME="U523400"> 6</A>   |<A NAME="U523402"> 5</A> |<A NAME="U523404"> 4</A> |<A NAME="U523406"> 3</A> |<A NAME="U523408"> 2</A>  |<A NAME="U523410"> 1</A>  |<A NAME="U523412"> 0</A>  
=======|===|=====|===|===|===|====|====|====
<A NAME="U523414">Byte 0</A> |<A NAME="U523416">MT</A> |<A NAME="U523418"> MFM</A> |<A NAME="U523420">SK</A> |<A NAME="U523422">1</A>  |<A NAME="U523424">0</A>  |<A NAME="U523426">0</A>   |<A NAME="U523428">0</A>   |<A NAME="U523430">1</A>   
-------|---|-----|---|---|---|----|----|----
<A NAME="U523432">Byte 1</A> |<A NAME="U523434">0</A>  |<A NAME="U523436"> 0</A>   |<A NAME="U523438"> 0</A> |<A NAME="U523440"> 0</A> |<A NAME="U523442"> 0</A> |<A NAME="U523444"> HD</A> |<A NAME="U523446"> US</A> |<A NAME="U523448"> US</A> 
-------|---|-----|---|---|---|----|----|----
<A NAME="U523450">Byte 2</A> |<A NAME="U523452">Track Number</A>                                 
-------|------------------------------------
<A NAME="U523468">Byte 3</A> |<A NAME="U523470">Head Address</A>                                 
-------|------------------------------------
<A NAME="U523486">Byte 4</A> |<A NAME="U523488">Sector Number</A>                                 
-------|------------------------------------
<A NAME="U523504">Byte 5</A> |<A NAME="U523506">Number of Data Bytes in Sector</A>                             
-------|------------------------------------
<A NAME="U528841">Byte 6</A> |<A NAME="U528843">End-of-Track</A>                                 
-------|------------------------------------
<A NAME="U528859">Byte 7</A> |<A NAME="U528861">Gap Length</A>                                 
-------|------------------------------------
<A NAME="U528877">Byte 8</A> |<A NAME="U528879">Scan Test</A>                                 
       |                                    
============================================
</pre>
<H5><A NAME="U527563">3.5.1.12.2  Execution Phase</A></H5>
<A NAME="U532970">Data transferred from the system to the controller is compared to data read from the disk.</A><p>
<H5><A NAME="U532969">3.5.1.12.3  Result Phase</A></H5>
<pre>
<A NAME="U535071">Table 97. Scan Equal Result Phase </A> 
=======================================
<A NAME="U527438">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U527456">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U527474">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U527492">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U527510">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U527528">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U527546">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U523659"></A><H4><A NAME="HDR24">3.5.1.13  Scan High or Equal Command</A></H4>
<H5><A NAME="U523787">3.5.1.13.1  Command Phase</A></H5>
<pre>
<A NAME="U535161">Table 98. Scan High or Equal Command Phase </A> 
============================================
       |<A NAME="U523664">7</A>  |<A NAME="U523666"> 6</A>   |<A NAME="U523668"> 5</A> |<A NAME="U523670"> 4</A> |<A NAME="U523672"> 3</A> |<A NAME="U523674"> 2</A>  |<A NAME="U523676"> 1</A>  |<A NAME="U523678"> 0</A>  
=======|===|=====|===|===|===|====|====|====
<A NAME="U523680">Byte 0</A> |<A NAME="U523682">MT</A> |<A NAME="U523684"> MFM</A> |<A NAME="U523686">SK</A> |<A NAME="U523688">1</A>  |<A NAME="U523690">1</A>  |<A NAME="U523692">1</A>   |<A NAME="U523694">0</A>   |<A NAME="U523696">1</A>   
-------|---|-----|---|---|---|----|----|----
<A NAME="U523698">Byte 1</A> |<A NAME="U523700">0</A>  |<A NAME="U523702"> 0</A>   |<A NAME="U523704"> 0</A> |<A NAME="U523706"> 0</A> |<A NAME="U523708"> 0</A> |<A NAME="U523710"> HD</A> |<A NAME="U523712"> US</A> |<A NAME="U523714"> US</A> 
-------|---|-----|---|---|---|----|----|----
<A NAME="U523716">Byte 2</A> |<A NAME="U523718">Track Number</A>                                 
-------|------------------------------------
<A NAME="U523734">Byte 3</A> |<A NAME="U523736">Head Address</A>                                 
-------|------------------------------------
<A NAME="U523752">Byte 4</A> |<A NAME="U523754">Sector Number</A>                                 
-------|------------------------------------
<A NAME="U523770">Byte 5</A> |<A NAME="U523772">Number of Data Bytes in Sector</A>                             
-------|------------------------------------
<A NAME="U528942">Byte 6</A> |<A NAME="U528944">End-of-Track</A>                                 
-------|------------------------------------
<A NAME="U528960">Byte 7</A> |<A NAME="U528962">Gap Length</A>                                 
-------|------------------------------------
<A NAME="U528978">Byte 8</A> |<A NAME="U528980">Scan Test</A>                                 
       |                                    
============================================
</pre>
<H5><A NAME="U527696">3.5.1.13.2  Execution Phase</A></H5>
<A NAME="U532972">Data transferred from the systems to the controller is compared to data read from the disk.</A><p>
<H5><A NAME="U532971">3.5.1.13.3  Result Phase</A></H5>
<pre>
<A NAME="U535107">Table 99. Scan High or Equal Result Phase </A> 
=======================================
<A NAME="U527571">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U527589">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U527607">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U527625">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U527643">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U527661">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U527679">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U523921"></A><H4><A NAME="HDR25">3.5.1.14  Scan Low or Equal Command</A></H4>
<H5><A NAME="U524049">3.5.1.14.1  Command Phase</A></H5>
<pre>
<A NAME="U535197">Table 100. Scan Low or Equal Command Phase </A> 
=============================================
       |<A NAME="U523926">7</A>   |<A NAME="U523928"> 6</A>   |<A NAME="U523930"> 5</A> |<A NAME="U523932"> 4</A> |<A NAME="U523934"> 3</A> |<A NAME="U523936"> 2</A>  |<A NAME="U523938"> 1</A>  |<A NAME="U523940"> 0</A>  
=======|====|=====|===|===|===|====|====|====
<A NAME="U523942">Byte 0</A> |<A NAME="U523944"> MT</A> |<A NAME="U523946"> MFM</A> |<A NAME="U523948">SK</A> |<A NAME="U523950">1</A>  |<A NAME="U523952">1</A>  |<A NAME="U523954">0</A>   |<A NAME="U523956">0</A>   |<A NAME="U523958">1</A>   
-------|----|-----|---|---|---|----|----|----
<A NAME="U523960">Byte 1</A> |<A NAME="U523962">0</A>   |<A NAME="U523964"> 0</A>   |<A NAME="U523966"> 0</A> |<A NAME="U523968"> 0</A> |<A NAME="U523970"> 0</A> |<A NAME="U523972"> HD</A> |<A NAME="U523974"> US</A> |<A NAME="U523976"> US</A> 
-------|----|-----|---|---|---|----|----|----
<A NAME="U523978">Byte 2</A> |<A NAME="U523980">Track Number</A>                                 
-------|-------------------------------------
<A NAME="U523996">Byte 3</A> |<A NAME="U523998">Head Address</A>                                 
-------|-------------------------------------
<A NAME="U524014">Byte 4</A> |<A NAME="U524016">Sector Number</A>                                 
-------|-------------------------------------
<A NAME="U524032">Byte 5</A> |<A NAME="U524034">Number of Data Bytes in Sector</A>                             
-------|-------------------------------------
<A NAME="U529041">Byte 6</A> |<A NAME="U529043">End-of-Track</A>                                 
-------|-------------------------------------
<A NAME="U529059">Byte 7</A> |<A NAME="U529061">Gap Length</A>                                 
-------|-------------------------------------
<A NAME="U529077">Byte 8</A> |<A NAME="U529079">Scan Test</A>                                 
       |                                     
=============================================
</pre>
<H5><A NAME="U527829">3.5.1.14.2  Execution Phase</A></H5>
<A NAME="U532974">Data transferred from the system to the controller is compared to data read from the disk.</A><p>
<H5><A NAME="U532973">3.5.1.14.3  Result Phase</A></H5>
<pre>
<A NAME="U535143">Table 101. Scan Low or Equal Result Phase </A> 
=======================================
<A NAME="U527704">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U527722">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U527740">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U527758">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U527776">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U527794">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U527812">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U524184"></A><H4><A NAME="HDR26">3.5.1.15  Seek Command</A></H4>
<H5><A NAME="U524312">3.5.1.15.1  Command Phase</A></H5>
<pre>
<A NAME="U535233">Table 102. Seek Command Phase </A> 
==========================================
       |<A NAME="U524189">7</A>  |<A NAME="U524191"> 6</A> |<A NAME="U524193"> 5</A> |<A NAME="U524195"> 4</A> |<A NAME="U524197"> 3</A> |<A NAME="U524199"> 2</A>  |<A NAME="U524201"> 1</A>  |<A NAME="U524203"> 0</A>  
=======|===|===|===|===|===|====|====|====
<A NAME="U524205">Byte 0</A> |<A NAME="U524207"> 0</A> |<A NAME="U524209">0</A>  |<A NAME="U524211"> 0</A> |<A NAME="U524213"> 0</A> |<A NAME="U524215">1</A>  |<A NAME="U524217">1</A>   |<A NAME="U524219">1</A>   |<A NAME="U524221">1</A>   
-------|---|---|---|---|---|----|----|----
<A NAME="U535561">Byte 1</A> |<A NAME="U524225">0</A>  |<A NAME="U524227"> 0</A> |<A NAME="U524229"> 0</A> |<A NAME="U524231"> 0</A> |<A NAME="U524233"> 0</A> |<A NAME="U524235"> HD</A> |<A NAME="U524237"> US</A> |<A NAME="U524239"> US</A> 
-------|---|---|---|---|---|----|----|----
<A NAME="U535895">Byte 2</A> |<A NAME="U535897">New Track Number after Seek</A>                             
       |                                  
==========================================
</pre>
<H5><A NAME="U535926">3.5.1.15.2  .Execution Phase</A></H5>
<A NAME="U535927">The disk drive head is stepped in or out to a programmable track.</A><p>
<H5><A NAME="U532977">3.5.1.15.3  Result Phase</A></H5>
<A NAME="U529117">This command has no result phase.</A><p>
<A NAME="U524449"></A><H4><A NAME="HDR27">3.5.1.16  Sense Drive Status Command</A></H4>
<H5><A NAME="U524577">3.5.1.16.1  Command Phase</A></H5>
<pre>
<A NAME="U535269">Table 103. Sense Drive Status Command Phase </A> 
==========================================
       |<A NAME="U524454">7</A>  |<A NAME="U524456"> 6</A> |<A NAME="U524458"> 5</A> |<A NAME="U524460"> 4</A> |<A NAME="U524462"> 3</A> |<A NAME="U524464"> 2</A>  |<A NAME="U524466"> 1</A>  |<A NAME="U524468"> 0</A>  
=======|===|===|===|===|===|====|====|====
<A NAME="U524470">Byte 0</A> |<A NAME="U524472"> 0</A> |<A NAME="U524474">0</A>  |<A NAME="U524476"> 0</A> |<A NAME="U524478"> 0</A> |<A NAME="U524480">0</A>  |<A NAME="U524482">1</A>   |<A NAME="U524484">0</A>   |<A NAME="U524486">0</A>   
-------|---|---|---|---|---|----|----|----
<A NAME="U524488">Byte 1</A> |<A NAME="U524490">0</A>  |<A NAME="U524492"> 0</A> |<A NAME="U524494"> 0</A> |<A NAME="U524496"> 0</A> |<A NAME="U524498"> 0</A> |<A NAME="U524500"> HD</A> |<A NAME="U524502"> US</A> |<A NAME="U524504"> US</A> 
       |   |   |   |   |   |    |    |    
==========================================
</pre>
<H5><A NAME="U527962">3.5.1.16.2  Result Phase</A></H5>
<pre>
<A NAME="U535179">Table 104. Sense Drive Status Result Phase </A> 
===========================
<A NAME="U527837">Byte 0</A> |Status Register 3
       |
===========================
</pre>
<A NAME="U532979"></A><H4><A NAME="HDR28">3.5.1.17  Sense Interrupt Status</A></H4>
<H5><A NAME="U524848">3.5.1.17.1  Command Phase</A></H5>
<pre>
<A NAME="U535305">Table 105. Sense Interrupt Status Command Phase </A> 
=======================================
       |<A NAME="U524725">7</A>  |<A NAME="U524727"> 6</A> |<A NAME="U524729"> 5</A> |<A NAME="U524731"> 4</A> |<A NAME="U524733"> 3</A> |<A NAME="U524735"> 2</A> |<A NAME="U524737"> 1</A> |<A NAME="U524739"> 0</A> 
=======|===|===|===|===|===|===|===|===
<A NAME="U524741">Byte 0</A> |<A NAME="U524743"> 0</A> |<A NAME="U524745">0</A>  |<A NAME="U524747"> 0</A> |<A NAME="U524749"> 0</A> |<A NAME="U524751">1</A>  |<A NAME="U524753">0</A>  |<A NAME="U524755">0</A>  |<A NAME="U524757">0</A>  
       |   |   |   |   |   |   |   |   
=======================================
</pre>
<H5><A NAME="U528097">3.5.1.17.2  Execution Phase</A></H5>
<A NAME="U532981">The status of the interrupt is reported.</A><p>
<H5><A NAME="U532980">3.5.1.17.3  Result Phase</A></H5>
<pre>
<A NAME="U535215">Table 106. Sense Interrupt Status Result Phase </A> 
=============================
<A NAME="U527972">Byte 0</A> |Status Register 0
-------|---------------------
<A NAME="U535935">Byte 1</A> |Present Track Number
       |
=============================
</pre>
<A NAME="U532982"></A><H4><A NAME="HDR29">3.5.1.18  Specify Command</A></H4>
<H5><A NAME="U525113">3.5.1.18.1  Command Phase</A></H5>
<pre>
<A NAME="U535341">Table 107. Specify Command Phase </A> 
==============================================
       |<A NAME="U524990">7</A>  |<A NAME="U524992"> 6</A> |<A NAME="U524994"> 5</A> |<A NAME="U524996"> 4</A>    |<A NAME="U524998"> 3</A> |<A NAME="U525000"> 2</A> |<A NAME="U525002"> 1</A> |<A NAME="U525004"> 0</A>  
=======|===|===|===|======|===|===|===|=======
<A NAME="U525006">Byte 0</A> |<A NAME="U525008"> 0</A> |<A NAME="U525010"> 0</A> |<A NAME="U525012"> 0</A> |<A NAME="U525014"> 0</A>    |<A NAME="U525016"> 0</A> |<A NAME="U525018"> 0</A> |<A NAME="U525020"> 1</A> |<A NAME="U525022"> 1</A>   
-------|---|---|---|------|---|---|---|-------
<A NAME="U525024">Byte 1</A> |<A NAME="U525026">Stepping Rate Time</A>|<A NAME="U525034"> Head Unload Time</A>             
-------|------------------|-------------------
<A NAME="U525042">Byte 2</A> |<A NAME="U525044">Head Load Time</A>                |<A NAME="U525058">DMA</A> 
       |                              |    
==============================================
</pre>
<H5><A NAME="U525241">3.5.1.18.2  Execution Phase</A></H5>
<A NAME="U532984">Internal registers are written.</A><p>
<H5><A NAME="U532983">3.5.1.18.3  Result Phase</A></H5>
<A NAME="U529160">This command has no result phase.</A><p>
<A NAME="U529159"></A><H4><A NAME="HDR30">3.5.1.19  Verify Command</A></H4>
<H5><A NAME="U525377">3.5.1.19.1  Command Phase</A></H5>
<pre>
<A NAME="U535359">Table 108. Verify Command Phase</A> 
============================================
       |<A NAME="U525254">7</A>  |<A NAME="U525256"> 6</A>   |<A NAME="U525258"> 5</A> |<A NAME="U525260"> 4</A> |<A NAME="U525262"> 3</A> |<A NAME="U525264"> 2</A>  |<A NAME="U525266"> 1</A>  |<A NAME="U525268"> 0</A>  
=======|===|=====|===|===|===|====|====|====
<A NAME="U525270">Byte 0</A> |<A NAME="U525272">MT</A> |<A NAME="U525274"> MFM</A> |<A NAME="U525276">SK</A> |<A NAME="U525278">1</A>  |<A NAME="U525280">0</A>  |<A NAME="U525282">1</A>   |<A NAME="U525284">1</A>   |<A NAME="U525286">0</A>   
-------|---|-----|---|---|---|----|----|----
<A NAME="U525288">Byte 1</A> |<A NAME="U525290">EC</A> |<A NAME="U525292"> 0</A>   |<A NAME="U525294"> 0</A> |<A NAME="U525296"> 0</A> |<A NAME="U525298"> 0</A> |<A NAME="U525300"> HD</A> |<A NAME="U525302"> US</A> |<A NAME="U525304"> US</A> 
-------|---|-----|---|---|---|----|----|----
<A NAME="U525306">Byte 2</A> |<A NAME="U525308">Track Number</A>                                 
-------|------------------------------------
<A NAME="U525324">Byte 3</A> |<A NAME="U525326">Head Address</A>                                 
-------|------------------------------------
<A NAME="U525342">Byte 4</A> |<A NAME="U525344">Sector Address</A>                                 
-------|------------------------------------
<A NAME="U525360">Byte 5</A> |<A NAME="U525362">Sector Size</A>                                 
-------|------------------------------------
<A NAME="U529197">Byte 6</A> |<A NAME="U529199">End-of-Track</A>                                 
-------|------------------------------------
<A NAME="U529215">Byte 7</A> |<A NAME="U529217">Gap Length</A>                                 
-------|------------------------------------
<A NAME="U529233">Byte 8</A> |<A NAME="U529235">Byte Transfer Control</A>                                 
       |                                    
============================================
</pre>
<H5><A NAME="U528230">3.5.1.19.2  Execution Phase</A></H5>
<A NAME="U532986">Data is read from the disk but not transferred to the system.</A><p>
<H5><A NAME="U532985">3.5.1.19.3  Result Phase</A></H5>
<pre>
<A NAME="U535251">Table 109. Verify Result Phase</A> 
===========================
<A NAME="U528105">Byte 0</A> |Status Register 0
-------|-------------------
<A NAME="U528123">Byte 1</A> |Status Register 1
-------|-------------------
<A NAME="U528141">Byte 2</A> |Status Register 2
-------|-------------------
<A NAME="U528159">Byte 3</A> |Track Number
-------|-------------------
<A NAME="U528177">Byte 4</A> |Head Address
-------|-------------------
<A NAME="U528195">Byte 5</A> |Sector Number
-------|-------------------
<A NAME="U528213">Byte 6</A> |Number of Data Bytes in Sector
       |
===========================
</pre>
<A NAME="U525514"></A><H4><A NAME="HDR31">3.5.1.20  Version Command</A></H4>
<H5><A NAME="U525642">3.5.1.20.1  Command Phase</A></H5>
<pre>
<A NAME="U535395">Table 110. Version Command Phase </A> 
=======================================
       |<A NAME="U525519">7</A>  |<A NAME="U525521"> 6</A> |<A NAME="U525523"> 5</A> |<A NAME="U525525"> 4</A> |<A NAME="U525527"> 3</A> |<A NAME="U525529"> 2</A> |<A NAME="U525531"> 1</A> |<A NAME="U525533"> 0</A> 
=======|===|===|===|===|===|===|===|===
<A NAME="U525535">Byte 0</A> |<A NAME="U525537"> 0</A> |<A NAME="U525539">0</A>  |<A NAME="U525541"> 0</A> |<A NAME="U525543">1</A>  |<A NAME="U525545">0</A>  |<A NAME="U525547">0</A>  |<A NAME="U525549">0</A>  |<A NAME="U525551">0</A>  
       |   |   |   |   |   |   |   |   
=======================================
</pre>
<H5><A NAME="U525770">3.5.1.20.2  Result Phase</A></H5>
<pre>
<A NAME="U535413">Table 111. Version Result Phase </A> 
======================================
       |<A NAME="U525647">7</A> |<A NAME="U525649"> 6</A> |<A NAME="U525651"> 5</A> |<A NAME="U525653"> 4</A> |<A NAME="U525655"> 3</A> |<A NAME="U525657"> 2</A> |<A NAME="U525659"> 1</A> |<A NAME="U525661"> 0</A> 
=======|==|===|===|===|===|===|===|===
<A NAME="U525663">Byte 0</A> |<A NAME="U525665">1</A> |<A NAME="U525667">0</A>  |<A NAME="U525669">0</A>  |<A NAME="U525671">X</A>  |<A NAME="U525673">0</A>  |<A NAME="U525675">0</A>  |<A NAME="U525677">0</A>  |<A NAME="U525679">0</A>  
       |  |   |   |   |   |   |   |   
======================================
</pre>
<A NAME="U528239">X can be a 1 or a 0.</A><p>
<A NAME="U525781"></A><H4><A NAME="HDR32">3.5.1.21  Write Data Command</A></H4>
<H5><A NAME="U525909">3.5.1.21.1  Command Phase</A></H5>
<pre>
<A NAME="U535431">Table 112. Write Data Command Phase </A> 
=============================================
       |<A NAME="U525786">7</A>   |<A NAME="U525788"> 6</A>   |<A NAME="U525790"> 5</A> |<A NAME="U525792"> 4</A> |<A NAME="U525794"> 3</A> |<A NAME="U525796"> 2</A>  |<A NAME="U525798"> 1</A>  |<A NAME="U525800"> 0</A>  
=======|====|=====|===|===|===|====|====|====
<A NAME="U525802">Byte 0</A> |<A NAME="U525804"> MT</A> |<A NAME="U525806"> MFM</A> |<A NAME="U525808"> 0</A> |<A NAME="U525810"> 0</A> |<A NAME="U525812">0</A>  |<A NAME="U525814">1</A>   |<A NAME="U525816">0</A>   |<A NAME="U525818">1</A>   
-------|----|-----|---|---|---|----|----|----
<A NAME="U525820">Byte 1</A> |<A NAME="U525822">0</A>   |<A NAME="U525824"> 0</A>   |<A NAME="U525826"> 0</A> |<A NAME="U525828"> 0</A> |<A NAME="U525830"> 0</A> |<A NAME="U525832"> HD</A> |<A NAME="U525834"> US</A> |<A NAME="U525836"> US</A> 
-------|----|-----|---|---|---|----|----|----
<A NAME="U525838">Byte 2</A> |<A NAME="U525840">Track Address</A>                                 
-------|-------------------------------------
<A NAME="U525856">Byte 3</A> |<A NAME="U525858">Head Address</A>                                 
-------|-------------------------------------
<A NAME="U525874">Byte 4</A> |<A NAME="U525876">Sector Number</A>                                 
-------|-------------------------------------
<A NAME="U525892">Byte 5</A> |<A NAME="U525894">Number of Data Bytes in Sector</A>                             
-------|-------------------------------------
<A NAME="U529326">Byte 6</A> |<A NAME="U529328">End-of-Track</A>                                 
-------|-------------------------------------
<A NAME="U529344">Byte 7</A> |<A NAME="U529346">Gap Length</A>                                 
-------|-------------------------------------
<A NAME="U529362">Byte 8</A> |<A NAME="U529364">Data Length</A>                                 
       |                                     
=============================================
</pre>
<H5><A NAME="U528368">3.5.1.21.2  Execution Phase</A></H5>
<A NAME="U532988">Data is transferred from the system to the controller via DMA or non-DMA modes and written to the disk.</A><p>
<H5><A NAME="U532987">3.5.1.21.3  Result Phase</A></H5>
<pre>
<A NAME="U535287">Table 113. Write Data Result Phase</A> 
=======================================
<A NAME="U528243">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U528261">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U528279">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U528297">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U528315">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U528333">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U528351">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U534017"></A><A NAME="U526045"></A><H4><A NAME="REF38677">3.5.1.22  Write Deleted Data Command</A></H4>
<H5><A NAME="U526173">3.5.1.22.1  Command Phase</A></H5>
<pre>
<A NAME="U535449">Table 114. Write Deleted Command Phase </A> 
=============================================
       |<A NAME="U526050">7</A>   |<A NAME="U526052"> 6</A>   |<A NAME="U526054"> 5</A> |<A NAME="U526056"> 4</A> |<A NAME="U526058"> 3</A> |<A NAME="U526060"> 2</A>  |<A NAME="U526062"> 1</A>  |<A NAME="U526064"> 0</A>  
=======|====|=====|===|===|===|====|====|====
<A NAME="U526066">Byte 0</A> |<A NAME="U526068"> MT</A> |<A NAME="U526070"> MFM</A> |<A NAME="U526072"> 0</A> |<A NAME="U526074"> 0</A> |<A NAME="U526076">1</A>  |<A NAME="U526078">0</A>   |<A NAME="U526080">0</A>   |<A NAME="U526082">1</A>   
-------|----|-----|---|---|---|----|----|----
<A NAME="U526084">Byte 1</A> |<A NAME="U526086">0</A>   |<A NAME="U526088"> 0</A>   |<A NAME="U526090"> 0</A> |<A NAME="U526092"> 0</A> |<A NAME="U526094"> 0</A> |<A NAME="U526096"> HD</A> |<A NAME="U526098"> US</A> |<A NAME="U526100"> US</A> 
-------|----|-----|---|---|---|----|----|----
<A NAME="U526102">Byte 2</A> |<A NAME="U526104">Track Number</A>                                 
-------|-------------------------------------
<A NAME="U535969">Byte 3</A> |<A NAME="U535971">Head Address</A>                                 
-------|-------------------------------------
<A NAME="U535987">Byte 4</A> |<A NAME="U535989">Sector Number</A>                                 
-------|-------------------------------------
<A NAME="U536005">Byte 5</A> |<A NAME="U536007">Number of Data Bytes in Sector</A>                             
-------|-------------------------------------
<A NAME="U526120">Byte 6</A> |<A NAME="U526122">End of Track</A>                                 
-------|-------------------------------------
<A NAME="U526138">Byte 7</A> |<A NAME="U526140">Gap Length</A>                                 
-------|-------------------------------------
<A NAME="U526156">Byte 8</A> |<A NAME="U526158">Data Length</A>                                 
       |                                     
=============================================
</pre>
<H5><A NAME="U528504">3.5.1.22.2  Execution Phase</A></H5>
<A NAME="U532990">Data is transferred from the system to the controller via DMA or non-DMA modes and written to the disk.</A><p>
<H5><A NAME="U532989">3.5.1.22.3  Result Phase</A></H5>
<pre>
<A NAME="U535323">Table 115. Write Deleted Result Phase </A> 
=======================================
<A NAME="U528379">Byte 0</A> |Status Register 0
-------|-------------------------------
<A NAME="U528397">Byte 1</A> |Status Register 1
-------|-------------------------------
<A NAME="U528415">Byte 2</A> |Status Register 2
-------|-------------------------------
<A NAME="U528433">Byte 3</A> |Track Number
-------|-------------------------------
<A NAME="U528451">Byte 4</A> |Head Address
-------|-------------------------------
<A NAME="U528469">Byte 5</A> |Sector Number
-------|-------------------------------
<A NAME="U528487">Byte 6</A> |Number of Data Bytes in Sector
       |
=======================================
</pre>
<A NAME="U526566"></A><H4><A NAME="HDR33">3.5.1.23  Invalid Command Status</A></H4>
<H5><A NAME="U528769">3.5.1.23.1  Result Phase. The following status byte is returned to the system microprocessor when an invalid command has been received.</A></H5>
<pre>
<A NAME="U535377">Table 116. Invalid Command Status Register</A> 
===========================
<A NAME="U528644">Byte 0</A> |Status Register 0
       |
===========================
</pre>
<A NAME="U528772">Bits 6 and 7 in status register 0 are used to indicate command status. When an invalid command is processed, this information is returned to the system microprocessor in the invalid command status byte.</A><p>
<A NAME="U534333"></A><H3><A NAME="HDR34">3.5.2  Command Status Registers Provided During Result Phase</A></H3>
<A NAME="U534334">This section provides definitions for status registers 0 through 3. These registers are read through the Data Register (FIFO) during the result phase of a floppy disk operation.</A><p>
<H3><A NAME="U534335">Requirements:</A></H3>

<DL>
<A NAME="U534339"><DD>3-14.  For the device described herein, the Command Status Registers described in <A HREF="floppy5.mak.html#REF29767">Section 3.5.2.1, "Status Register 0 (ST0)," on page 56</A> through <A HREF="floppy5.mak.html#REF12062">Section 3.5.2.4, "Status Register 3 (ST3)," on page 58</A> must be implemented as specified.</A><BR>
<A NAME="U534344"></A></DL>


<A NAME="U534410"></A><H4><A NAME="REF29767">3.5.2.1  Status Register 0 (ST0)</A></H4>
<pre>
<A NAME="U534347">Table 117. Status Register 0 </A> 
=========================================================================================================================================
<A NAME="U534355">Bit</A>  |<A NAME="U534357"> Function</A>                                                                                                |<A NAME="U534359">Value when </A>   |<A NAME="U534361">Value on </A> 
     |                                                                                                         |OF passes to  |Software  
     |                                                                                                         |SW            |Reset     
=====|=========================================================================================================|==============|==========
<A NAME="U534363">7, 6</A> |<A NAME="U534365"><B>Interrupt Code:</B>These bits indicate the command interrupt status as given in <A HREF="floppy5.mak.html#REF24997">Table 118 on page 57</A>.</A>        |<A NAME="U534367">0</A>             |<A NAME="U534369">0</A>         
-----|---------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U534371">5</A>    |<A NAME="U534373"><B>Seek End: </B>This bit is set to 1 when the diskette drive completes the Seek or Recalibrate command, </A>       |<A NAME="U534375">0</A>             |<A NAME="U534377">0</A>         
     |or a read or write operation with an implied Seek command.                                               |              |          
-----|---------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U534379">4</A>    |<A NAME="U534381"><B>Equipment Check: </B>This bit is set to 1 if the '-track 0' signal fails to occur after the Recalibrate com-</A> |<A NAME="U534383">0</A>             |<A NAME="U534385">0</A>         
     |mand is issued or Relative Seek command to step outward beyond track 0                                   |              |          
-----|---------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U534387">3</A>    |<A NAME="U534389"><B>Reserved: </B>This bit is always set to 0</A>                                                                    |<A NAME="U534391">0</A>             |<A NAME="U534393">0</A>         
-----|---------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U534395">2</A>    |<A NAME="U534397"><B>Head Select: </B>This bit indicates the state of the '-head select' signal after the command was per-</A>        |<A NAME="U534399">0</A>             |<A NAME="U534401">0</A>         
     |formed. When set to 1, head 1 was selected: when set to 0. head O was selected.                          |              |          
-----|---------------------------------------------------------------------------------------------------------|--------------|----------
<A NAME="U534403">1, 0</A> |<A NAME="U534405"><B>Drive Select: </B>These bits indicate the drive that was selected upon command completion</A>                    |<A NAME="U534407">0</A>             |<A NAME="U534409">0</A>         
     |                                                                                                         |              |          
=========================================================================================================================================
</pre>
<pre>
<A NAME="U534416"></A>
<A NAME="U534417"></A><A NAME="REF24997">Table 118. Encodings for the Interrupt Code field (bits 7,6 of ST0)</A> 
================================================
<A NAME="U534421">Bits 7 6</A> |<A NAME="U534423">Function</A>                              
=========|======================================
<A NAME="U534425">0 0</A>      |<A NAME="U534427">Normal Termination of Command</A>         
---------|--------------------------------------
<A NAME="U534429">0 1</A>      |<A NAME="U534431">Abnormal Termination of Command</A>       
---------|--------------------------------------
<A NAME="U534433">10</A>       |<A NAME="U534435">Invalid Command Issued</A>                
---------|--------------------------------------
<A NAME="U534437">11</A>       |<A NAME="U534439">Internal drive ready status changed </A>  
         |state during the drive polling mode.  
         |Only occurs after a hardware or soft- 
         |ware reset.                           
         |                                      
================================================
</pre>
<pre>
<A NAME="U534447">Table 119. Drive Select Bits</A> 
===================
<A NAME="U534451">Bits 1 0</A> |<A NAME="U534453">Function</A> 
=========|=========
<A NAME="U534455">0 0</A>      |<A NAME="U534457">Drive 0</A>  
---------|---------
<A NAME="U534459">0 1</A>      |<A NAME="U534461">Drive 1</A>  
---------|---------
<A NAME="U534463">1 0</A>      |<A NAME="U534465">Drive 2</A>  
---------|---------
<A NAME="U534467">1 1</A>      |<A NAME="U534469">Drive 3</A>  
         |         
===================
</pre>
<A NAME="U534512"></A><H4><A NAME="HDR35">3.5.2.2  Status Register 1 (ST1)</A></H4>
<pre>
<A NAME="U534473">Table 120. Status Register 1 </A> 
================================================================================================================================
<A NAME="U534477">Bit</A> |<A NAME="U534479">Function</A>                                                                                                                   
====|===========================================================================================================================
<A NAME="U534481">7</A>   |<A NAME="U534483"><B>End-of-Track</B>: This bit is set to 1 when the controller tries to gain access to a sector beyond the final sector of a track</A> 
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534485">6</A>   |<A NAME="U534487">Reserved: This bit is always set to 0.</A>                                                                                     
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534489">5</A>   |<A NAME="U534491">Cyclic Redundancy Check (CRC) Error: This bit is set to 1 when a CRC error is detected in the ID </A>                          
    |or data field.                                                                                                             
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534493">4</A>   |<A NAME="U534495"><B>Overrun/Underrun Error: </B>This bit is set to 1 if the system does not service the diskette drive controller within an ad-</A>    
    |equate period of time during data transfers.                                                                               
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534497">3</A>   |<A NAME="U534499">Reserved: This bit is always set to 0.</A>                                                                                     
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534501">2</A>   |<A NAME="U534503"><B>No Data: </B>This bit is set to 1 when</A>                                                                                         
    |<A NAME="U537520">  The controller cannot find the sector specified in the ID register during the execution of a Read </A>                      
    |Data, Read Deleted Data, or Read ID or Read Track command.                                                                 
    |<A NAME="U537521">  The controller cannot read the ID field without an error during the execution of a Read ID </A>                             
    |command                                                                                                                    
    |<A NAME="U537533">  The starting sector cannot be found during the execution of a Read Track command</A>                                        
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534505">1</A>   |<A NAME="U537501"><B>Not Writable:</B> This bit is set to 1 when the '-write-protect' signal is active during a Write Data, Write Deleted Data, or </A> 
    |Format Track command.                                                                                                      
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534509">0</A>   |<A NAME="U534511"><B>Missing Address Mark: </B>This bit is set to 1 if the controller cannot detect an address mark. When this occurs, bit 0 of </A>    
    |Status Register 2 indicates whether the missing address mark is an ID-address mark or a data-address mark.                 
    |                                                                                                                           
================================================================================================================================
</pre>
<A NAME="U534565"></A><H4><A NAME="HDR36">3.5.2.3  Status Register 2 (ST2)</A></H4>
<pre>
<A NAME="U534526">Table 121. Status Register 2</A> 
================================================================================================================================
<A NAME="U534530">Bit</A> |<A NAME="U534532"> Function</A>                                                                                                                  
====|===========================================================================================================================
<A NAME="U534534">7</A>   |<A NAME="U534536">Reserved: This bit is always set to 0.</A>                                                                                     
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534538">6</A>   |<A NAME="U534540">Control Mark: This bit is set to 1 when the controller encounters a sector that has a deleted data-address mark during a </A>  
    |Read Data or a Read Deleted Data encounters a data address mark.                                                           
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534542">5</A>   |<A NAME="U534544">CRC Error in Data Field: This bit is set to 1 if the controller detects an error in the data.</A>                              
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534546">4</A>   |<A NAME="U534548">Wrong Track: This bit is set to 1 when the track number on the media is different from the track number issued by the </A>     
    |command. When this occurs, bit 2 of Status Register 1 is also set to 1.                                                    
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534550">3</A>   |<A NAME="U534552">Scan Equal Hit: This bit is set to 1 during the Scan command when the conditions for Equal are satisfied.</A>                  
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534554">2</A>   |<A NAME="U534556">Scan Not Satisfied: This bit is set to 1 during the Scan Command when the scan conditions are not satisfied.</A>               
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534558">1</A>   |<A NAME="U534560">Bad Track: This bit is set to 1 when the track number on the media is hex FF and the track number value stored in the </A>     
    |ID      register is not hex FF. When this occurs, bit 2 of Status Register 1 is also set to 1.                             
----|---------------------------------------------------------------------------------------------------------------------------
<A NAME="U534562">0</A>   |<A NAME="U534564">Missing Address Mark in Data Field: This bit is set to 1 when the controller cannot find a data-address mark. This bit </A>    
    |is set to 0 when an ID-address mark cannot be found. Bit 0 in Status Register 0 is also set if either address mark cannot  
    |be found.                                                                                                                  
    |                                                                                                                           
================================================================================================================================
</pre>
<A NAME="U534574"></A><A NAME="U534612"></A><H4><A NAME="REF12062">3.5.2.4  Status Register 3 (ST3)</A></H4>
<pre>
<A NAME="U534577">Table 122. Status Register 3 </A> 
=========================================================================================================================================
<A NAME="U534581">Bit</A>  |<A NAME="U534583">Function</A>                                                                                                                           
=====|===================================================================================================================================
<A NAME="U534585">7</A>    |<A NAME="U537613">Reserved: This bit is always set to 0</A>                                                                                              
-----|-----------------------------------------------------------------------------------------------------------------------------------
<A NAME="U534589">6</A>    |<A NAME="U534591">Write Protect: This bit indicates the status of the '-write-protect' signal from the diskette drive. When this bit is set to 1, </A>   
     |the'-write-protect' signal is active.                                                                                              
-----|-----------------------------------------------------------------------------------------------------------------------------------
<A NAME="U534593">5</A>    |<A NAME="U534595">Reserved: This bit is always set to 1.</A>                                                                                             
-----|-----------------------------------------------------------------------------------------------------------------------------------
<A NAME="U534597">4</A>    |<A NAME="U534599">Track 0: This bit indicates the status of the '-track O' signal from the diskette drive. When this bit is set to 1, the '-track 0 </A> 
     |signal is active.                                                                                                                  
-----|-----------------------------------------------------------------------------------------------------------------------------------
<A NAME="U534601">3</A>    |<A NAME="U534603">Reserved: This bit is always set to 1.</A>                                                                                             
-----|-----------------------------------------------------------------------------------------------------------------------------------
<A NAME="U534605">2</A>    |<A NAME="U534607">Head Address: This bit indicates the status of the '-head 1 select' signal from the diskette drive. When this bit is set to 1, </A>    
     |the '-head 1 select' signal is active.                                                                                             
-----|-----------------------------------------------------------------------------------------------------------------------------------
<A NAME="U534609">1, 0</A> |<A NAME="U534611">Drive Select: These bits indicate the current selected drive.</A>                                                                      
     |                                                                                                                                   
=========================================================================================================================================
</pre>
<A NAME="U534195"></A><H2><A NAME="HDR37">3.6  Media Sense</A></H2>
<H3><A NAME="U534198">Requirements:</A></H3>

<DL>
<A NAME="U536798"><DD>3-15.  The disk drive must be configured in a manner such that the Disk in Place signal, on the drive, is functionally a state indicator of the presence of media. The signal must assert an active level when a disk is present in the drive and an inactive level when there is no disk in the drive.</A><BR>
</DL>


<A NAME="U536845"></A><H2><A NAME="HDR38">3.7  Floppy Drive Signal Connector Pin Assignment</A></H2>
<pre>
<A NAME="U536806">Table 123. Signal Connector Pin Assignment</A> 
==================================================
<A NAME="U536810">PIN</A> |<A NAME="U536812"> Signal Description</A> |<A NAME="U536857">PIN</A> |<A NAME="U536859">Signal Description</A> 
====|====================|====|===================
<A NAME="U536814">1</A>   |<A NAME="U536816">AUTO EJECT *</A>        |<A NAME="U536861">2</A>   |<A NAME="U536863">N. C.</A>              
----|--------------------|----|-------------------
<A NAME="U536818">3</A>   |<A NAME="U536820">Key</A>                 |<A NAME="U536865">4</A>   |<A NAME="U536867">HD OUT</A>             
----|--------------------|----|-------------------
<A NAME="U536822">5</A>   |<A NAME="U536824">Ground</A>              |<A NAME="U536869">6</A>   |<A NAME="U536871">DISK IN PLACE *</A>    
----|--------------------|----|-------------------
<A NAME="U536826">7</A>   |<A NAME="U536828">Ground</A>              |<A NAME="U536873">8</A>   |<A NAME="U536875">INDEX</A>              
----|--------------------|----|-------------------
<A NAME="U536830">9</A>   |<A NAME="U536832">Ground</A>              |<A NAME="U536877">10</A>  |<A NAME="U536879">DRIVE SELECT 0</A>     
----|--------------------|----|-------------------
<A NAME="U536834">11</A>  |<A NAME="U536836">Ground</A>              |<A NAME="U536881">12</A>  |<A NAME="U536883">DRIVE SELECT 1</A>     
----|--------------------|----|-------------------
<A NAME="U536838">13</A>  |<A NAME="U536840">Ground</A>              |<A NAME="U536885">14</A>  |<A NAME="U536887">N. C.</A>              
----|--------------------|----|-------------------
<A NAME="U536842">15</A>  |<A NAME="U536844">Ground</A>              |<A NAME="U536889">16</A>  |<A NAME="U536891">MOTOR ON</A>           
----|--------------------|----|-------------------
<A NAME="U536993">17</A>  |<A NAME="U536995">Ground</A>              |<A NAME="U536997">18</A>  |<A NAME="U536999">DIRECTION</A>          
----|--------------------|----|-------------------
<A NAME="U536985">19</A>  |<A NAME="U536987">Ground</A>              |<A NAME="U536989">20</A>  |<A NAME="U536991">STEP</A>               
----|--------------------|----|-------------------
<A NAME="U536977">21</A>  |<A NAME="U536979">Ground</A>              |<A NAME="U536981">22</A>  |<A NAME="U536983">WRITE DATA</A>         
----|--------------------|----|-------------------
<A NAME="U536969">23</A>  |<A NAME="U536971">Ground</A>              |<A NAME="U536973">24</A>  |<A NAME="U536975">WRITE GATE</A>         
----|--------------------|----|-------------------
<A NAME="U536961">25</A>  |<A NAME="U536963">Ground</A>              |<A NAME="U536965">26</A>  |<A NAME="U536967">TRACK 00</A>           
----|--------------------|----|-------------------
<A NAME="U536953">27</A>  |<A NAME="U536955">Ground</A>              |<A NAME="U536957">28</A>  |<A NAME="U536959">WRITE PROTECT</A>      
----|--------------------|----|-------------------
<A NAME="U536945">29</A>  |<A NAME="U536947">Ground</A>              |<A NAME="U536949">30</A>  |<A NAME="U536951">READ DATA</A>          
----|--------------------|----|-------------------
<A NAME="U536937">31</A>  |<A NAME="U536939">Ground</A>              |<A NAME="U536941">32</A>  |<A NAME="U536943">HEAD SELECT</A>        
----|--------------------|----|-------------------
<A NAME="U536929">33</A>  |<A NAME="U536931">Ground</A>              |<A NAME="U536933">34</A>  |<A NAME="U536935">DISK CHANGE</A>        
    |                    |    |                   
==================================================
</pre>
<A NAME="U536799"><B>Hardware Implementation Note:</B> Signal pins AUTOEJECT, signal pin 1, DISK IN PLACE, signal pin 6, and HD OUT, signal pin 4, must be gated by Drive Select, if the drive is used in platforms that support multiple drives.</A><p>
<A NAME="U537039"></A><H2><A NAME="HDR39">3.8  References</A></H2>

<OL>
<A NAME="U534107"><LI><I>National Semiconductor PC87308VUL SuperI/O Enhanced Sidewinder Lite Plug and Play Compatible Chip, with a Floppy Disk Controller, a Keyboard Controller, a Real-Time Clock, Two UARTs, Full Infrared Support and an IEEE1284 Parallel Port</I> [<A HREF="refinfo.html#REF30109">24</A>].</A><BR>

<A NAME="U534108"><LI><I>National Semiconductor PC87332VLJ (3.3V/5V) and PC87332VLJ-5 (5V) (SuperI/O III Premium Green) with Floppy Disk Controller, Dual UARTs, IEEE 1284 Parallel Port, and IDE Interface</I> [<A HREF="refinfo.html#REF40638">26</A>].</A><BR>
<A NAME="U539621"></A></OL>

<A NAME="ENDFILE"><PRE> </PRE></A><A HREF="io_ref.bk.html"><IMG SRC="fm2html-toc.gif">Table of Contents</A> <A HREF="intr5.mak.html"><IMG SRC="fm2html-next.gif">Next Chapter</A> 


<!-- END CONTENT -->
<!-- BEGIN FOOTER -->
</WhiteSpace> 
					</TD>
				</TR>
			</TABLE>

		</TD>
	</TR>
	<TR>
		<TD COLSPAN=2 WIDTH=150 HEIGHT=17 ALIGN=LEFT VALIGN=TOP><NOBR><A HREF="http://www.ibm.com/Privacy/"><IMG SRC="http://www.ibm.com/i/v9/f/en/privacy.gif" WIDTH=53 HEIGHT=19 ALT="Privacy" HSPACE=0 VSPACE=0 BORDER=0></font></A><A HREF="http://www.ibm.com/Legal/"><IMG SRC="http://www.ibm.com/i/v9/f/en/legal.gif" WIDTH=41 HEIGHT=19 ALT="Legal" HSPACE=0 VSPACE=0 BORDER=0></font></A><A HREF="http://www.ibm.com/Contact/"><IMG SRC="http://www.ibm.com/i/v9/f/en/contact.gif" WIDTH=56 HEIGHT=19 ALT="Contact" HSPACE=0 VSPACE=0 BORDER=0></font></A></NOBR></TD>
		<TD WIDTH=10><IMG SRC="/graphics/c.gif" WIDTH=10></TD>
	</TR>
</TABLE>
</BODY>


<!--  END FOOTER -->
</BODY>
</HTML>
